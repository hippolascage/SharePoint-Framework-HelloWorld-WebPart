import ServiceScope from '../serviceScope/ServiceScope';
/**
 * The ODataBatch class accumulates a number of REST service calls and
 * transmits them as a single ODATA batch.  This protocol is documented here:
 * http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html
 *
 * The usage is to call ODataBatch.fetch() to queue each individual request,
 * and then call ODataBatch.execute() to execute the batch operation.
 * The execute() method returns a promise that resolves when the real REST
 * call has completed.  Each call to fetch() also returns a promise that will
 * resolve with a Response object for that particular request.
 *
 * @public
 */
export default class ODataBatch {
    private _batchOptions;
    private _fetchProvider;
    private _randomProvider;
    private _digestCache;
    private _batchedRequests;
    private _webUrl;
    constructor(serviceScope: ServiceScope, batchOptions?: IODataBatchOptions);
    /**
     * Queues a new request, and returns a promise that can be used to access
     * the server response (after execute() has completed).  The parameters for
     * this function are basically the same as the WHATWG API standard documented here:
     * https://fetch.spec.whatwg.org/
     *
     * However, be aware that certain REST headers are ignored or not allowed inside
     * a batch.  See the ODATA documentation for details.
     *
     * When execute() is called, it will POST to a URL such as
     * "http://example.com/sites/sample/_api/$batch".  Typically ODataBatch can successfully
     * guess the appropriate SPWeb URL by looking for a reserved URL segment such as "_api"
     * in the first URL passed to fetch().  If not, use IODataBatchOptions.webUrl to specify it
     * explicitly.
     *
     * @params url - the URL to fetch, or an already initialized Request object
     * @params options - additional options that affect the request
     * @returns a promise that will return the result
     */
    fetch(url: string, options?: IODataBatchRequestOptions): Promise<Response>;
    /**
     * Calls fetch(), but sets the method to 'GET'.
     * @params url - the URL to fetch
     * @params options - additional options that affect the request
     * @returns a promise that will return the result
     */
    get(url: string, options?: IODataBatchRequestOptions): Promise<Response>;
    /**
     * Calls fetch(), but sets the method to 'POST'.
     * @params url - the URL to fetch
     * @params options - additional options that affect the request
     * @returns a promise that will return the result
     */
    post(url: string, options: IODataBatchRequestOptions): Promise<Response>;
    /**
     * Executes the batched queries that were queued using ODataBatch.fetch().
     */
    execute(): Promise<ODataBatch>;
    private _parseResponsesFromBody(text);
}
/**
 * This interface is passed to the ODataBatch constructor.  It specifies options
 * that affect the entire batch.
 * @public
 */
export interface IODataBatchOptions {
    /**
     * ODataBatch will need to perform its POST to an endpoint such as
     * "http://example.com/sites/sample/_api/$batch". Typically the SPWeb URL
     * ("https://example.com/sites/sample" in this example) can be guessed by
     * looking for a reserved URL segment such as "_api" in the first URL
     * passed to fetch(), but if not, the webUrl can be explicitly specified
     * using this option.
     */
    webUrl?: string;
}
/**
 * This interface defines the options for an individual REST request that
 * is part of an ODataBatch.  It is based on the WHATWG API standard
 * parameters that are documented here:
 * https://fetch.spec.whatwg.org/
 * @public
 */
export interface IODataBatchRequestOptions extends RequestInit {
}
