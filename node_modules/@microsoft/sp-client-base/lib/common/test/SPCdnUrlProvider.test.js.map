{"version":3,"sources":["common/test/SPCdnUrlProvider.test.ts"],"names":[],"mappings":"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","file":"common/test/SPCdnUrlProvider.test.js","sourcesContent":["/**\r\n * @copyright (c) Microsoft Corporation. All rights reserved.\r\n */\r\n\r\nimport SPCdnUrlProvider from '../SPCdnUrlProvider';\r\n\r\nconst assert: Chai.AssertStatic = chai.assert;\r\n\r\ndescribe('SPCdnUrlProvider tests', () => {\r\n\r\n  const undefinedOrigins: string[] = undefined;\r\n\r\n  /* tslint:disable:no-null-keyword */\r\n  const nullOrigins: string[] = null;\r\n  const validOriginsWithNull: string[] = [null];\r\n  const validOriginsWithNullAndNotNull: string[] = [null, 'invalidHashString'];\r\n  /* tslint:enable:no-null-keyword */\r\n\r\n  const emptyOrigins: string[] = [];\r\n\r\n  const validOriginsWithOneItem: string[] = [\r\n    '14180066cedf3e9177eaa015c7f0c4e9ea30f411e8683345915af0381f510f42acde990e'\r\n  ];\r\n\r\n  const validOriginsWithTwoItems: string[] = [\r\n    '14180066cedf3e9177eaa015c7f0c4e9ea30f411e8683345915af0381f510f42acde990d',\r\n    '14180066cedf3e9177eaa015c7f0c4e9ea30f411e8683345915af0381f510f42acde990e'\r\n  ];\r\n\r\n  const invalidOriginsWithNonNumericLength: string[] = [\r\n    '1418-NO-cedf3e9177eaa015c7f0c4e9ea30f411e8683345915af0381f510f42acde990e'\r\n  ];\r\n\r\n  const validAssetUrl: string =\r\n    'https://msft.spoppe.com/sites/wex/SiteAssets/SitePages/Victor-Page/image.jpg';\r\n\r\n  const validAssetUrlWithParam: string =\r\n    'https://msft.spoppe.com/sites/wex/SiteAssets/SitePages/Victor-Page/image.jpg?param1=foo&Param2=bar';\r\n\r\n  const validAssetUrlWithNoItem: string =\r\n    'https://msft.spoppe.com/sites/wex/SiteAssets/SitePages/Victor-Page/';\r\n\r\n  const validCdnUrlWithNoItem: string =\r\n    `${window.location.protocol}//publiccdn.sharepointonline.com/${window.location.host}/` +\r\n    '14180066cedf3e9177eaa015c7f0c4e9ea30f411e8683345915af0381f510f42acde990e/';\r\n\r\n  const validCdnUrl: string = validCdnUrlWithNoItem + 'image.jpg';\r\n  const validCdnUrlWithParams: string = validCdnUrlWithNoItem + 'image.jpg?param1=foo&Param2=bar';\r\n  const invalidAssetUrl: string = 'https://msft.spoppe.com/sites/wex/SiteAssets/SitePages/Victor-Page';\r\n  const invalidAssetUrlPrifix: string = 'https://msft.spoppe.com/sites/wex/SiteAssets/SitePages/Victor-Page-Plus';\r\n  const otherAssetUrl: string = 'https://someotherdomain/sites/wex/SiteAssets/SitePages/Victor-Page';\r\n\r\n  it('Can parse an undefined origins array', () => {\r\n    SPCdnUrlProvider.initialize(undefinedOrigins);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an null origins array', () => {\r\n    SPCdnUrlProvider.initialize(nullOrigins);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an empty origins array', () => {\r\n    SPCdnUrlProvider.initialize(emptyOrigins);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an validOriginsWithNull array', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithNull);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an validOriginsWithNullAndNotNull array', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithNullAndNotNull);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an validOriginsWithOneItem array', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithOneItem);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an validOriginsWithTwoItems array', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can parse an origin with non-numeric invalid lenght component', () => {\r\n    SPCdnUrlProvider.initialize(invalidOriginsWithNonNumericLength);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(otherAssetUrl) === otherAssetUrl);\r\n  });\r\n\r\n  it('Can match valid asset item url', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(validAssetUrl) === validCdnUrl);\r\n  });\r\n\r\n  it('Can match valid asset item url with QSP', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(validAssetUrlWithParam) === validCdnUrlWithParams);\r\n  });\r\n\r\n  it('Can match valid asset item url with no item', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(validAssetUrlWithNoItem) === validCdnUrlWithNoItem);\r\n  });\r\n\r\n  it('Can not match invalid asset item url with no item subpath', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(invalidAssetUrl) === invalidAssetUrl);\r\n  });\r\n\r\n  it('Can not match invalid asset item url where libraries share the same prefix', () => {\r\n    SPCdnUrlProvider.initialize(validOriginsWithTwoItems);\r\n    assert.isTrue(SPCdnUrlProvider.getCdnUrlIfEnabled(invalidAssetUrlPrifix) === invalidAssetUrlPrifix);\r\n  });\r\n});\r\n"],"sourceRoot":"/src"}