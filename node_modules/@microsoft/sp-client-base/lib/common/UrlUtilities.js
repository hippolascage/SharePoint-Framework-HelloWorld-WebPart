/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 */
"use strict";
var lodash = require('@microsoft/sp-lodash-subset');
var Validate_1 = require('./Validate');
/**
 * Common helper functions for working with URLs.  These utilities are intended to be simple,
 * small, and extremely common.  Do not add advanced parsing logic to this file.
 * @public
 */
var UrlUtilities = (function () {
    function UrlUtilities() {
    }
    /**
     * Removes any slash characters from the end of the URL.
     * This function assumes that the input is already a valid absolute or server-relative URL.
     * Examples:
     *   removeEndSlash('http://example.com/') ---> 'http://example.com'
     *   removeEndSlash('/example')            ---> '/example'
     *   removeEndSlash('/')                   ---> ''
     * @param url the URL to be normalized
     */
    UrlUtilities.removeEndSlash = function (url) {
        return lodash.trimEnd(url, '/');
    };
    /**
     * Converts a variable to an OData string literal and escapes apostrophes.
     * OData specification:
     * https://tools.oasis-open.org/version-control/
     *   browse/wsvn/odata/trunk/spec/ABNF/odata-abnf-construction-rules.txt
     * SQUOTE-in-string = SQUOTE SQUOTE ; two consecutive single quotes represent one within a string literal
     * Examples:
     *   convertToODataStringLiteral("example's list") ---> "'example''s list'"
     *   convertToODataStringLiteral("example list") ---> "'example list'"
     *   convertToODataStringLiteral("'example list'") ---> "'''example list'''"
     */
    UrlUtilities.convertToODataStringLiteral = function (value) {
        Validate_1.default.isNotNullOrUndefined(value, 'value');
        value = value.replace(/'/g, "''");
        value = "'" + value + "'";
        return value;
    };
    return UrlUtilities;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = UrlUtilities;

//# sourceMappingURL=UrlUtilities.js.map
