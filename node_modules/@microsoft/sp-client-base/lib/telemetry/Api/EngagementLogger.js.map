{"version":3,"sources":["telemetry/Api/EngagementLogger.ts"],"names":[],"mappings":"AAAA;;;;GAIG;;AAEH,sCAA2B,2BAA2B,CAAC,CAAA;AAGvD;;;;;;GAMG;AACH;IAAA;IAyDA,CAAC;IAxDC;;;;;;;;;;OAUG;IACW,yBAAQ,GAAtB,UAAuB,OAAe,EAAE,UAAmB;QACzD,EAAE,CAAC,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YACrC,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACzC,CAAC;QAED,+DAA+D;QAC/D,IAAM,YAAY,GAAW,sBAAsB,CAAC;QACpD,EAAE,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;YACzC,MAAM,IAAI,KAAK,CAAC,gEAAgE,CAAC,CAAC;QACpF,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,UAAU,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAC3C,kCAAU,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;QACxC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,kCAAU,CAAC,OAAO,CAAC;gBACjB,IAAI,EAAE,OAAO;gBACb,SAAS,EAAE;oBACT,MAAM,EAAE,UAAU;iBACnB;aACA,CAAC,CAAC;QACP,CAAC;IACH,CAAC;IAED;;;;;;;;;OASG;IACW,qCAAoB,GAAlC,UAAmC,QAAmB;QACpD,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;YACd,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;QACzC,CAAC;QAED,kCAAU,CAAC,OAAO,CAAC;YACjB,IAAI,EAAE,QAAQ,CAAC,UAAU,GAAG,GAAG,GAAG,QAAQ,CAAC,UAAU;YACnD,SAAS,EAAE;gBACT,OAAO,EAAE,QAAQ,CAAC,QAAQ,EAAE;aAC/B;SACF,CAAC,CAAC;IACL,CAAC;IACH,uBAAC;AAAD,CAzDA,AAyDC,IAAA;AAzDD;kCAyDC,CAAA","file":"telemetry/Api/EngagementLogger.js","sourcesContent":["/**\r\n * @copyright Microsoft Corporation.All rights reserved.\r\n * @file EngagementLogger.ts\r\n * EngagementLogger logger\r\n */\r\n\r\nimport { Engagement } from '@ms/odsp-utilities-bundle';\r\nimport ILogEntry from './ILogEntry';\r\n\r\n/**\r\n * Engagement logging\r\n * use *.Click for all the actions triggered by mouse, keyboard, or touch.\r\n * if you want to add more data or the action is not click but keydown.\r\n * Use extraData to log the type of action or use extraData to log details wrapped in LogEntry\r\n * @internal\r\n */\r\nexport default class EngagementLogger {\r\n  /**\r\n   * Engagement logging\r\n   * Use *.Click for all the actions triggered by mouse, keyboard, or touch.\r\n   * tagName follows <ApplicationName>.controlName.actionName pattern\r\n   * For example, tagName = \"AddButton.Click\",\r\n   * this logs \"<ApplicationName>.AddButton.Click\" with default action triggered by mouse, keyboard, or touch.\r\n   * <ApplicationName> is set in ApplicationLogSettings\r\n   * Use extraData to log the type of action.\r\n   * For example, actionName = \"Keydown\" and tagName = \"ModernPublish.AddButton.Click\"\r\n   * this logs \"<ApplicationName>.AddButton.Click\" with the extraData that it was selected using the Keydown\r\n   */\r\n  public static logEvent(tagName: string, actionName?: string): void {\r\n    if (!tagName || tagName.length === 0) {\r\n      throw new Error('LogEntry is invalid');\r\n    }\r\n\r\n    // tagName should follow AppName.ControlName.ActionName pattern\r\n    const tagNameRegex: RegExp = /(\\w+)\\.(\\w+).(\\w+)/ig;\r\n    if (tagNameRegex.test(tagName) === false) {\r\n      throw new Error('tagName does not follow AppName.ControlName.ActionName pattern');\r\n    }\r\n\r\n    if (!actionName || actionName.length === 0) {\r\n      Engagement.logData({ name: tagName });\r\n    } else {\r\n      Engagement.logData({\r\n        name: tagName,\r\n        extraData: {\r\n          action: actionName\r\n        }\r\n        });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Engagement logging with LogEntry\r\n   * Here is an example: {\"EngagementName\":\"SPPage.NavigationAction.SPPageQuickLaunchUpdate\",\r\n   * \"Properties\":\"{\\\"message\\\":\\\"[NavigationAction] | SPPageQuickLaunchUpdate | 2 | null\\\"}\",\r\n   * \"Duration\":0,\"LogType\":0,\r\n   * \"ClientTime\":1459357627444,\"Source\":\"ClientV2Engagement\"}\r\n   * NavigationAction is moduleName in LogEntry, SPPageQuickLaunchUpdate is log feature name\r\n   * In this example, SPPage is application name which is set in ApplicationLogSettings\r\n   * Do NOT add PII data!\r\n   */\r\n  public static logEventWithLogEntry(logEntry: ILogEntry): void {\r\n    if (!logEntry) {\r\n      throw new Error('LogEntry is invalid');\r\n    }\r\n\r\n    Engagement.logData({\r\n      name: logEntry.moduleName + '.' + logEntry.logFeature,\r\n        extraData: {\r\n          message: logEntry.toString()\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}