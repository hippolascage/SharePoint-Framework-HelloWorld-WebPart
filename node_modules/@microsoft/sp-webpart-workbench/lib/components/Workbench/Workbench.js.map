{"version":3,"sources":["components/Workbench/Workbench.tsx"],"names":[],"mappings":"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","file":"components/Workbench/Workbench.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * @file Workbench.tsx\r\n * The top level file for the Workbench. The Workbench is a tool that SharePoint\r\n * developers use to test their Web Parts. It is designed to make development\r\n * efficient by providing a production-like evironment for the developer to\r\n * test their Web Part and quickly make changes.\r\n */\r\n\r\nimport * as React from 'react';\r\n\r\nimport ZoneHost from '../zoneHost/ZoneHost';\r\nimport CommandBar from '../commandBar/CommandBar';\r\nimport DetailsPane from '../detailsPane/DetailsPane';\r\nimport Page from '../page/Page';\r\nimport { observer } from 'mobservable-react';\r\nimport { PageStore } from '../page/PageStore';\r\nimport WebPartStore from '../../stores/WebPartStore';\r\nimport { IWorkBenchStore } from './../../stores/WorkBenchStore';\r\nimport MobilePreview, { IMobilePreviewProps, DeviceType } from '../mobilePreview/mobilePreview/MobilePreview';\r\n\r\nimport './WorkBench.scss';\r\n\r\nexport interface IWorkBenchProps {\r\n  store: IWorkBenchStore;\r\n  pageStore: PageStore;\r\n}\r\n\r\nexport interface IWorkBenchState {\r\n  displayMobilePreview: boolean;\r\n  mobilePreviewDeviceType: DeviceType;\r\n}\r\n\r\nexport interface IWorkBenchContext {\r\n  pageStore: PageStore;\r\n  webPartStore: WebPartStore;\r\n}\r\n\r\n@observer export class WorkBench extends React.Component<IWorkBenchProps, IWorkBenchState> {\r\n  /* tslint:disable:no-any */\r\n  public static childContextTypes: any = {\r\n  /* tslint:enable:no-any */\r\n    pageStore: React.PropTypes.object,\r\n    webPartStore: React.PropTypes.object\r\n  };\r\n\r\n  private _webPartStore: WebPartStore;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this._webPartStore = new WebPartStore();\r\n\r\n    this.state = {\r\n      displayMobilePreview: false,\r\n      mobilePreviewDeviceType: DeviceType.Phone\r\n    };\r\n\r\n    this._onClickMobileView = this._onClickMobileView.bind(this);\r\n    this._onClickTabletView = this._onClickTabletView.bind(this);\r\n    this._closeMobilePreview = this._closeMobilePreview.bind(this);\r\n    this._setSuiteNavZIndex = this._setSuiteNavZIndex.bind(this);\r\n  }\r\n\r\n  // React magically finds this function by looking for the specific function name.\r\n  // https://facebook.github.io/react/docs/context.html\r\n  public getChildContext(): IWorkBenchContext {\r\n    return {\r\n      pageStore: this.props.pageStore,\r\n      webPartStore: this._webPartStore\r\n    };\r\n  }\r\n\r\n  public render(): React.ReactElement<IWorkBenchProps> {\r\n    const zones: React.ReactElement<{}>[] = [];\r\n    let mobilePreview: React.ReactElement<IMobilePreviewProps> = undefined;\r\n    const { addinType, isEditing, isDetailsPaneVisible }: IWorkBenchStore = this.props.store;\r\n    const rootClass: string = 'WorkBench ms-font-m' +\r\n      (isEditing ? ' is-editing' : '') +\r\n      (isDetailsPaneVisible ? ' has-pane' : '');\r\n\r\n    const pageStore: PageStore = this.props.pageStore;\r\n\r\n    if (addinType) {\r\n      zones.push(<ZoneHost addinType={ addinType } />);\r\n    }\r\n\r\n    if (this.state.displayMobilePreview) {\r\n      mobilePreview = <MobilePreview\r\n                      onExit = { this._closeMobilePreview }\r\n                      deviceType = { this.state.mobilePreviewDeviceType } />;\r\n    }\r\n\r\n    return (\r\n      <div className={ rootClass }>\r\n        <div className='WorkBench-header'>\r\n          <div className='WorkBench-headerMenu'>\r\n            <i className='ms-Icon ms-Icon--waffle'></i>\r\n          </div>\r\n          <div className='WorkBench-headerTitle ms-font-xl'><em>Office 365</em> SharePoint Workbench</div>\r\n          <div className='WorkBench-headerPerson'>\r\n            <i className='ms-Icon ms-Icon--person'></i>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <div id='workbenchCommandBar' className='WorkBench-commandBar'>\r\n            <CommandBar store={ pageStore } appStore={ this.props.store } onClickMobileView={ this._onClickMobileView }\r\n            onClickTabletView={ this._onClickTabletView } closeMobilePreview={ this._closeMobilePreview }/>\r\n          </div>\r\n          <div id='workbenchPageContent' className='WorkBench-pageContent'>\r\n            <Page store={ pageStore } appStore={ this.props.store } />\r\n\r\n            {/**\r\n              * @todo: DetailsPane is currently mandatory. The reason being that the WebPartStore makes the getWebPart\r\n              * API call and then updates the AddinPickerStore which in turn updaets the Toolbox Items. As we evolve the\r\n              * Workbench functionality and design, we need to design that correctly. But for now, we have a hidden\r\n              * DetailsPane component as a temporary hack.\r\n              */}\r\n            <DetailsPane />\r\n          </div>\r\n        </div>\r\n        { zones }\r\n        { mobilePreview }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onClickMobileView(): void {\r\n    this.setState({\r\n      displayMobilePreview: true,\r\n      mobilePreviewDeviceType: DeviceType.Phone\r\n    });\r\n    this._setSuiteNavZIndex('0');\r\n  }\r\n\r\n  private _onClickTabletView(): void {\r\n    this.setState({\r\n      displayMobilePreview: true,\r\n      mobilePreviewDeviceType: DeviceType.Tablet\r\n    });\r\n    this._setSuiteNavZIndex('0');\r\n  }\r\n\r\n  private _closeMobilePreview(): void {\r\n    this.setState({\r\n      displayMobilePreview: false,\r\n      mobilePreviewDeviceType: DeviceType.Phone\r\n    });\r\n    this._setSuiteNavZIndex('5');\r\n  }\r\n\r\n  /**\r\n   * Sets the z-index of the suite nav.\r\n   * Purpose of this is so that the suite nav doesn't cover up the mobile preview header.\r\n   * Should find a better way to achieve this.\r\n   */\r\n  private _setSuiteNavZIndex(value: string): void {\r\n    const suiteNav: HTMLElement = document.getElementById('SuiteNavPlaceHolder');\r\n    if (suiteNav) {\r\n      suiteNav.style.zIndex = value;\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}