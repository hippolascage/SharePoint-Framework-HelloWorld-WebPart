{"version":3,"sources":["packageSolution/packageSolution/xmlGenerators/createComponentXml.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;AACH,mCAAmC;;AAEnC,IAAY,IAAI,WAAM,MAAM,CAAC,CAAA;AAC7B,IAAY,YAAY,WAAM,KAAK,CAAC,CAAA;AAEpC,8BAA0B,yBAAyB,CAAC,CAAA;AAGpD,qCAAiC,wBAAwB,CAAC,CAAA;AAE1D,4BAA2C,OAAmB,EAAE,SAAiB;IAC/E,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,KAAK,uBAAa,CAAC,WAAW,CAAC,CAAC,CAAC;QAC/C,MAAM,CAAC;YACL,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,iBAAe,OAAO,CAAC,EAAE,SAAM,CAAC;YACrE,GAAG,EAAE,YAAY,CAAC;gBAChB,QAAQ,EAAE;oBACR;wBACE,mBAAmB,EAAE;4BACnB;gCACE,KAAK,EAAE;oCACL,IAAI,EAAE,OAAO,CAAC,IAAI;oCAClB,EAAE,EAAE,OAAO,CAAC,EAAE;oCACd,iBAAiB,EAAE,OAAO,CAAC,QAAQ;oCACnC,IAAI,EAAE,aAAa;iCACpB;6BACF;yBACF;qBACF;oBACD;wBACE,KAAK,EAAE;4BACL,KAAK,EAAE,0CAA0C;yBAClD;qBACF;iBACF;aACF,EAAE,8BAAoB,CAAC;SACzB,CAAC;IACJ,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,mEAAmE;QACnE,MAAM,CAAC;YACL,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,aAAW,OAAO,CAAC,EAAE,SAAM,CAAC;YACjE,GAAG,EAAE,YAAY,CAAC;gBAChB,QAAQ,EAAE;oBACR;wBACE,mBAAmB,EAAE;4BACnB;gCACE,KAAK,EAAE;oCACL,IAAI,EAAE,OAAO,CAAC,IAAI;oCAClB,EAAE,EAAE,OAAO,CAAC,EAAE;oCACd,iBAAiB,EAAE,OAAO,CAAC,QAAQ;oCACnC,IAAI,EAAE,SAAS;iCAChB;6BACF;yBACF;qBACF;oBACD;wBACE,MAAM,EAAE;4BACN;gCACE,KAAK,EAAE;oCACL,IAAI,EAAE,OAAO,CAAC,IAAI;oCAClB,GAAG,EAAE,cAAc;oCACnB,IAAI,EAAE,KAAK;iCACZ;6BACF;4BACD;gCACE,IAAI,EAAE;oCACJ;wCACE,KAAK,EAAE;4CACL,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,aAAW,OAAO,CAAC,EAAE,aAAU,CAAC;4CACjE,GAAG,EAAE,aAAW,OAAO,CAAC,EAAE,aAAU;4CACpC,IAAI,EAAE,oBAAoB;4CAC1B,qBAAqB,EAAE,MAAM;yCAC9B;qCACF;oCACD;wCACE,QAAQ,EAAE;4CACR;gDACE,KAAK,EAAE;oDACL,IAAI,EAAE,OAAO;oDACb,KAAK,EAAE,QAAQ;iDAChB;6CACF;yCACF;qCACF;iCACF;6BACF;yBACF;qBACF;oBACD;wBACE,KAAK,EAAE;4BACL,KAAK,EAAE,0CAA0C;yBAClD;qBACF;iBACF;aACF,EAAE,8BAAoB,CAAC;SACzB,CAAC;IACJ,CAAC;AACH,CAAC;AAtFD;oCAsFC,CAAA","file":"packageSolution/packageSolution/xmlGenerators/createComponentXml.js","sourcesContent":["/**\r\n * @file createComponentXml.ts\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * Creates an package's Element.Xml for a WebPart or ClientSideSolution\r\n */\r\n/// <reference path='./xml.d.ts' />\r\n\r\nimport * as path from 'path';\r\nimport * as XmlGenerator from 'xml';\r\n\r\nimport componentType from '../models/ComponentType';\r\nimport IComponent from '../models/packageDefinition/IComponent';\r\nimport IXml from '../models/packageXml/IXml';\r\nimport serializationOptions from './serializationOptions';\r\n\r\nexport default function createComponentXml(options: IComponent, featureId: string): IXml {\r\n  if (options.type === componentType.Application) {\r\n    return {\r\n      filename: path.posix.join(featureId, `Application_${options.id}.xml`),\r\n      xml: XmlGenerator({\r\n        Elements: [\r\n          {\r\n            ClientSideComponent: [\r\n              {\r\n                _attr: {\r\n                  Name: options.name,\r\n                  Id: options.id,\r\n                  ComponentManifest: options.manifest,\r\n                  Type: 'Application'\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            _attr: {\r\n              xmlns: 'http://schemas.microsoft.com/sharepoint/'\r\n            }\r\n          }\r\n        ]\r\n      }, serializationOptions)\r\n    };\r\n  } else {\r\n    // @todo Note that the options.id is NOT necessarily the feature ID\r\n    return {\r\n      filename: path.posix.join(featureId, `WebPart_${options.id}.xml`),\r\n      xml: XmlGenerator({\r\n        Elements: [\r\n          {\r\n            ClientSideComponent: [\r\n              {\r\n                _attr: {\r\n                  Name: options.name,\r\n                  Id: options.id,\r\n                  ComponentManifest: options.manifest,\r\n                  Type: 'WebPart'\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            Module: [\r\n              {\r\n                _attr: {\r\n                  Name: options.name,\r\n                  Url: '_catalogs/wp',\r\n                  List: '113'\r\n                }\r\n              },\r\n              {\r\n                File: [\r\n                  {\r\n                    _attr: {\r\n                      Path: path.posix.join(featureId, `WebPart_${options.id}.webpart`),\r\n                      Url: `WebPart_${options.id}.webpart`,\r\n                      Type: 'GhostableInLibrary',\r\n                      IgnoreIfAlreadyExists: 'TRUE'\r\n                    }\r\n                  },\r\n                  {\r\n                    Property: [\r\n                      {\r\n                        _attr: {\r\n                          Name: 'Group',\r\n                          Value: 'Custom'\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            _attr: {\r\n              xmlns: 'http://schemas.microsoft.com/sharepoint/'\r\n            }\r\n          }\r\n        ]\r\n      }, serializationOptions)\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}