{"version":3,"sources":["packageSolution/packageSolution/xmlGenerators/createWebPartXml.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;;AAEH,mCAAmC;AAEnC,IAAY,IAAI,WAAM,MAAM,CAAC,CAAA;AAC7B,IAAY,YAAY,WAAM,KAAK,CAAC,CAAA;AAIpC,qCAAiC,wBAAwB,CAAC,CAAA;AAE1D,+FAA+F;AAC/F,kDAAkD;AAClD,0BAAyC,OAAmB,EAAE,SAAiB;IAC/E,2BAA2B;IACzB,IAAM,eAAe,GAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC5D,uBAAuB;IAErB,IAAM,wBAAwB,GAC5B,UAAC,IAAY,EAAE,IAAY,EAAE,KAAa;QACxC,MAAM,CAAC;YACL,QAAQ,EAAE;gBACR;oBACE,KAAK,EAAE;wBACL,IAAI,EAAE,IAAI;wBACV,IAAI,EAAE,IAAI;qBACX;iBACF;gBACD,KAAK;aACN;SACF,CAAC;IACJ,CAAC,CAAC;IAEJ,MAAM,CAAC;QACL,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,aAAW,OAAO,CAAC,EAAE,aAAU,CAAC;QACrE,GAAG,EAAE,YAAY,CAAC;YAChB,QAAQ,EAAE;gBACR;oBACE,OAAO,EAAE;wBACP;4BACE,KAAK,EAAE;gCACL,KAAK,EAAE,yCAAyC;6BACjD;yBACF;wBACD;4BACE,QAAQ,EAAE;gCACR;oCACE,IAAI,EAAE;wCACJ;4CACE,KAAK,EAAE;gDACL,oCAAoC;gDACpC,IAAI,EAAE,+IAA+I;6CAEtJ;yCACF;qCACF;iCACF;gCACD;oCACE,kBAAkB,EAAE,6BAA6B;iCAClD;6BACF;yBACF;wBACD;4BACE,IAAI,EAAE;gCACJ;oCACE,UAAU,EAAE;wCACV,wBAAwB,CACtB,OAAO,EACP,QAAQ,EACR,eAAe,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC;wCAExD,wBAAwB,CACtB,aAAa,EACb,QAAQ,EACR,eAAe,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,OAAO,CAAC;wCAE9D,wBAAwB,CACtB,qBAAqB,EACrB,EAAE,EACF,OAAO,CAAC,EAAE,CAAC;wCAEb,wBAAwB,CACtB,uBAAuB,EACvB,QAAQ,EACR,EAAE,CAAC;qCACN;iCACF;6BACF;yBACF;qBACF;iBACF;aACF;SACF,EAAE,8BAAoB,CAAC;KACzB,CAAC;AACJ,CAAC;AAjFD;kCAiFC,CAAA","file":"packageSolution/packageSolution/xmlGenerators/createWebPartXml.js","sourcesContent":["/**\r\n * @file createwebPartFile.ts\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * Creates an .WebPart definition for a Client-Side WebPart\r\n */\r\n\r\n/// <reference path='./xml.d.ts' />\r\n\r\nimport * as path from 'path';\r\nimport * as XmlGenerator from 'xml';\r\n\r\nimport IComponent from '../models/packageDefinition/IComponent';\r\nimport IXml from '../models/packageXml/IXml';\r\nimport serializationOptions from './serializationOptions';\r\n\r\n// @todo: (SPPPLAT VSO#224409) Need to cleanup this implementation to generate as many .webpart\r\n// files as preconfiguredEntries and remove any's.\r\nexport default function createWebPartXml(webpart: IComponent, featureId: string): IXml {\r\n/* tslint:disable:no-any */\r\n  const webPartManifest: any = JSON.parse(webpart.manifest);\r\n/* tslint:any:no-any */\r\n\r\n  const createPropertyDefinition: (name: string, type: string, value: string) => Object =\r\n    (name: string, type: string, value: string) => {\r\n      return {\r\n        property: [\r\n          {\r\n            _attr: {\r\n              name: name,\r\n              type: type\r\n            }\r\n          },\r\n          value\r\n        ]\r\n      };\r\n    };\r\n\r\n  return {\r\n    filename: path.posix.join(featureId, `WebPart_${webpart.id}.webpart`),\r\n    xml: XmlGenerator({\r\n      webParts: [\r\n        {\r\n          webPart: [\r\n            {\r\n              _attr: {\r\n                xmlns: 'http://schemas.microsoft.com/WebPart/v3'\r\n              }\r\n            },\r\n            {\r\n              metaData: [\r\n                {\r\n                  type: [\r\n                    {\r\n                      _attr: {\r\n                        /* tslint:disable:max-line-length */\r\n                        name: 'Microsoft.SharePoint.WebPartPages.ClientSideWebPart, Microsoft.SharePoint, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'\r\n                        /* tslint:enable:max-line-length */\r\n                      }\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  importErrorMessage: 'Cannot import this Web Part'\r\n                }\r\n              ]\r\n            },\r\n            {\r\n              data: [\r\n                {\r\n                  properties: [\r\n                    createPropertyDefinition(\r\n                      'Title',\r\n                      'string',\r\n                      webPartManifest.preconfiguredEntries[0].title.default),\r\n\r\n                    createPropertyDefinition(\r\n                      'Description',\r\n                      'string',\r\n                      webPartManifest.preconfiguredEntries[0].description.default),\r\n\r\n                    createPropertyDefinition(\r\n                      'ClientSideWebPartId',\r\n                      '',\r\n                      webpart.id),\r\n\r\n                    createPropertyDefinition(\r\n                      'ClientSideWebPartData',\r\n                      'string',\r\n                      '')\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    }, serializationOptions)\r\n  };\r\n}\r\n"],"sourceRoot":"/source/"}