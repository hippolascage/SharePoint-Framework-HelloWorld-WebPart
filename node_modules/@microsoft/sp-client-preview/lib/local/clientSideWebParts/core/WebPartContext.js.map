{"version":3,"sources":["local/clientSideWebParts/core/WebPartContext.ts"],"names":[],"mappings":"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","file":"local/clientSideWebParts/core/WebPartContext.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * Web part context.\r\n */\r\n'use strict';\r\n\r\nimport { IClientSideWebPartManifestInstance } from '@microsoft/sp-module-interfaces';\r\nimport {\r\n  basicHttpClientServiceKey,\r\n  httpClientServiceKey,\r\n  _logSourceServiceKey,\r\n  pageContextServiceKey,\r\n  HttpClient,\r\n  BasicHttpClient,\r\n  PageContext,\r\n  ServiceScope,\r\n  _LogSource,\r\n  Environment,\r\n  environmentServiceKey\r\n} from '@microsoft/sp-client-base';\r\n\r\nimport ClientSideComponentContext from './ClientSideComponentContext';\r\nimport IClientSideWebPartStatusRenderer from './../../common/webParts/IClientSideWebPartStatusRenderer';\r\nimport { IEventAggregator } from '../../common/events/IEvent';\r\nimport IWebPartContext from './IWebPartContext';\r\nimport IWebPartHost from '../../common/webParts/IWebPartHost';\r\nimport IWebPartManagerContext from './IWebPartManagerContext';\r\nimport { PropertyPaneState } from '../../common/webParts/PropertyPaneDefinitions';\r\n\r\n/**\r\n * Web part context object. This object contains the contextual services available to a web part. e.g.\r\n * a contextual instance to the http client.\r\n */\r\n/* tslint:disable:no-any */\r\nexport default class WebPartContext\r\n  extends ClientSideComponentContext<IClientSideWebPartManifestInstance<any>>\r\n  implements IWebPartContext {\r\n/* tslint:enable:no-any */\r\n\r\n  private _instanceId: string;\r\n  private _webPartTag: string;\r\n  private _httpClient: HttpClient;\r\n  private _basicHttpClient: BasicHttpClient;\r\n  private _pageContext: PageContext;\r\n  private _statusRenderer: IClientSideWebPartStatusRenderer;\r\n  private _eventAggregator: IEventAggregator;\r\n  private _configureStart: (id: string, propertyPaneState?: PropertyPaneState) => void;\r\n  private _serviceScope: ServiceScope;\r\n  private _host: IWebPartHost;\r\n  private _environment: Environment;\r\n\r\n  constructor(\r\n    context: IWebPartManagerContext,\r\n    /* tslint:disable:no-any */\r\n    manifestInstance: IClientSideWebPartManifestInstance<any>,\r\n    /* tslint:enable:no-any */\r\n    host: IWebPartHost,\r\n    statusRenderer: IClientSideWebPartStatusRenderer,\r\n    eventAggregator: IEventAggregator,\r\n    configureStart: (id: string, propertyPaneState?: PropertyPaneState) => void,\r\n    webPartTag: string) {\r\n\r\n    super(context.domElement, manifestInstance);\r\n\r\n    this._instanceId = context.instanceId;\r\n    this._webPartTag = webPartTag;\r\n\r\n    this._host = host;\r\n    this._serviceScope = this._createWebPartServiceScope(host.serviceScope);\r\n    this._httpClient = this._serviceScope.consume(httpClientServiceKey);\r\n    this._basicHttpClient = this._serviceScope.consume(basicHttpClientServiceKey);\r\n    this._pageContext = this._serviceScope.consume(pageContextServiceKey);\r\n    this._environment = this._serviceScope.consume(environmentServiceKey);\r\n\r\n    this._statusRenderer = statusRenderer;\r\n    this._eventAggregator = eventAggregator;\r\n    this._configureStart = configureStart;\r\n  }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get instanceId(): string { return this._instanceId; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get webPartTag(): string { return this._webPartTag; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get httpClient(): HttpClient { return this._httpClient; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get basicHttpClient(): BasicHttpClient { return this._basicHttpClient; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get pageContext(): PageContext { return this._pageContext; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get statusRenderer(): IClientSideWebPartStatusRenderer { return this._statusRenderer; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get eventAggregator(): IEventAggregator { return this._eventAggregator; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get configureStart(): (id: string, propertyPaneState?: PropertyPaneState) => void {\r\n    return this._configureStart;\r\n  }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get host(): IWebPartHost { return this._host; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get serviceScope(): ServiceScope { return this._serviceScope; }\r\n\r\n  /**\r\n   * @see IWebPartContext\r\n   */\r\n  public get environment(): Environment { return this._environment; }\r\n\r\n  /**\r\n   * Create a web part specific service scope.\r\n   *\r\n   * @param context - Web part manager context\r\n   */\r\n  private _createWebPartServiceScope(parentScope: ServiceScope): ServiceScope {\r\n    const webPartScope: ServiceScope = parentScope.startNewChild();\r\n    webPartScope.createDefaultAndProvide(basicHttpClientServiceKey);\r\n    webPartScope.createDefaultAndProvide(httpClientServiceKey);\r\n    webPartScope.provide(_logSourceServiceKey, _LogSource.create(this._webPartTag));\r\n    webPartScope.finish();\r\n    return webPartScope;\r\n  }\r\n}"],"sourceRoot":"/src"}