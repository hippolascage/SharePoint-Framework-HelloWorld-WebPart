/**
 * @Copyright (c) Microsoft Corporation.  All rights reserved.
 *
 * Web part context.
 */
'use strict';
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var sp_client_base_1 = require('@microsoft/sp-client-base');
var ClientSideComponentContext_1 = require('./ClientSideComponentContext');
/**
 * Web part context object. This object contains the contextual services available to a web part. e.g.
 * a contextual instance to the http client.
 */
/* tslint:disable:no-any */
var WebPartContext = (function (_super) {
    __extends(WebPartContext, _super);
    function WebPartContext(context, 
        /* tslint:disable:no-any */
        manifestInstance, 
        /* tslint:enable:no-any */
        host, statusRenderer, eventAggregator, configureStart, webPartTag) {
        _super.call(this, context.domElement, manifestInstance);
        this._instanceId = context.instanceId;
        this._webPartTag = webPartTag;
        this._host = host;
        this._serviceScope = this._createWebPartServiceScope(host.serviceScope);
        this._httpClient = this._serviceScope.consume(sp_client_base_1.httpClientServiceKey);
        this._basicHttpClient = this._serviceScope.consume(sp_client_base_1.basicHttpClientServiceKey);
        this._pageContext = this._serviceScope.consume(sp_client_base_1.pageContextServiceKey);
        this._environment = this._serviceScope.consume(sp_client_base_1.environmentServiceKey);
        this._statusRenderer = statusRenderer;
        this._eventAggregator = eventAggregator;
        this._configureStart = configureStart;
    }
    Object.defineProperty(WebPartContext.prototype, "instanceId", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._instanceId; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "webPartTag", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._webPartTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "httpClient", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._httpClient; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "basicHttpClient", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._basicHttpClient; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "pageContext", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._pageContext; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "statusRenderer", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._statusRenderer; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "eventAggregator", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._eventAggregator; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "configureStart", {
        /**
         * @see IWebPartContext
         */
        get: function () {
            return this._configureStart;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "host", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._host; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "serviceScope", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._serviceScope; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "environment", {
        /**
         * @see IWebPartContext
         */
        get: function () { return this._environment; },
        enumerable: true,
        configurable: true
    });
    /**
     * Create a web part specific service scope.
     *
     * @param context - Web part manager context
     */
    WebPartContext.prototype._createWebPartServiceScope = function (parentScope) {
        var webPartScope = parentScope.startNewChild();
        webPartScope.createDefaultAndProvide(sp_client_base_1.basicHttpClientServiceKey);
        webPartScope.createDefaultAndProvide(sp_client_base_1.httpClientServiceKey);
        webPartScope.provide(sp_client_base_1._logSourceServiceKey, sp_client_base_1._LogSource.create(this._webPartTag));
        webPartScope.finish();
        return webPartScope;
    };
    return WebPartContext;
}(ClientSideComponentContext_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = WebPartContext;

//# sourceMappingURL=WebPartContext.js.map
