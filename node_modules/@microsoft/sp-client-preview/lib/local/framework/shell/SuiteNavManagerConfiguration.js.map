{"version":3,"sources":["local/framework/shell/SuiteNavManagerConfiguration.ts"],"names":[],"mappings":"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","file":"local/framework/shell/SuiteNavManagerConfiguration.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * @file Represents a set of app specific configuration for the suite nav manager.\r\n */\r\n\r\nimport ISuiteNavManagerConfiguration from '../../common/suiteNav/ISuiteNavManagerConfiguration';\r\nimport { IO365ShellRenderSettings } from '../../common/suiteNav/IO365Shell';\r\nimport ISuiteNavData from '../../common/suiteNav/models/ISuiteNavData';\r\nimport ISuiteNavLink from '../../common/suiteNav/models/ISuiteNavLink';\r\nimport SuiteNavLinkIds from '../../common/suiteNav/models/SuiteNavLinkIds';\r\nimport AppPageContext from '../pageContext/AppPageContext';\r\n\r\nexport default class SuiteNavManagerConfiguration implements ISuiteNavManagerConfiguration {\r\n  private _pageContext: AppPageContext;\r\n  private _currentUICultureName: string;\r\n  private _o365ShellRenderSettings: IO365ShellRenderSettings;\r\n  private _siteClientTag: string;\r\n  private _systemUserKey: string;\r\n  private _webServerRelativeUrl: string;\r\n  private _hamburgerMenuCallback: () => void;\r\n  private _suiteNavPostRenderCallback: () => void;\r\n  private _isSuiteNavDisabled: boolean;\r\n  private _settingsLinks: ISuiteNavLink[];\r\n  private _signoutUrl: string;\r\n\r\n  /**\r\n   * Initializes a new instance of the SuiteNavManagerConfiguration.\r\n   */\r\n  constructor(pageContext: AppPageContext) {\r\n    this._pageContext = pageContext;\r\n    this._currentUICultureName = this._pageContext.core.currentUICultureName;\r\n    this._webServerRelativeUrl = this._pageContext.core.webServerRelativeUrl;\r\n    this._o365ShellRenderSettings = {\r\n      disableDelayLoad: false,\r\n      disableShellPlus: false,\r\n      layout: 'Mouse',\r\n      top: undefined\r\n    };\r\n    this._hamburgerMenuCallback = undefined;\r\n    this._suiteNavPostRenderCallback = undefined;\r\n    this._systemUserKey = this._pageContext.core.systemUserKey;\r\n    this._siteClientTag = this._pageContext.core.siteClientTag;\r\n    this._isSuiteNavDisabled = this._shouldDisableSuiteNav();\r\n    if (this._pageContext.core.menuData) {\r\n      /* tslint:disable:no-string-literal */\r\n      this._settingsLinks = this._pageContext.core.menuData['SettingsData'];\r\n      this._signoutUrl = this._pageContext.core.menuData['SignOutUrl'];\r\n      /* tslint:enable:no-string-literal */\r\n    }\r\n  }\r\n\r\n  public isSuiteNavDisabled(): boolean {\r\n    return this._isSuiteNavDisabled;\r\n  }\r\n\r\n  /**\r\n   * Function for disabling the suiteNav from loading\r\n   */\r\n  public disableSuiteNav(): void {\r\n    this._isSuiteNavDisabled = true;\r\n  }\r\n\r\n  /**\r\n   * Function for modifying the suite nav data that came back from the service.\r\n   * @param new SuiteNav data to replace the current data\r\n   * @returns the new SuiteNav data\r\n   */\r\n  public modifySuiteNavData(suiteNavData: ISuiteNavData): ISuiteNavData {\r\n    // For now, always assume we're on the SharePoint home page.\r\n    suiteNavData.CurrentMainLinkElementID = SuiteNavLinkIds.SITES;\r\n\r\n    suiteNavData.CurrentWorkloadSettingsSubLinks =\r\n     this._settingsLinks && this._settingsLinks.length > 0 ? this._settingsLinks : undefined;\r\n    suiteNavData.FeedbackLink = undefined;\r\n    if (suiteNavData.SignOutLink) {\r\n      suiteNavData.SignOutLink.Url = this._signoutUrl;\r\n    }\r\n    return suiteNavData;\r\n  };\r\n\r\n  /**\r\n   * Gets the systemUserKey token.\r\n   * @returns the systemUserKey or empty string\r\n   */\r\n  public get systemUserKey(): string {\r\n    return this._systemUserKey || '';\r\n  }\r\n\r\n  /**\r\n   * Gets the cache token.\r\n   * @returns the site client tag or empty string\r\n   */\r\n  public get cacheToken(): string {\r\n    /**\r\n     * The site client tag will be something like '0$$16.0.3912.1218' -- the only part\r\n     * we care about is before the $$. This number will be incremented if the user's theme changes.\r\n     */\r\n    const clientTag: string = this._siteClientTag;\r\n\r\n    if (clientTag !== undefined) {\r\n      return clientTag.substring(0, clientTag.indexOf('$$'));\r\n    }\r\n    return '';\r\n  };\r\n\r\n  /**\r\n   * Gets the o365ShellRenderSettings for rendering the SuiteNav.\r\n   * @returns _o365ShellRenderSettings\r\n   */\r\n  public get o365ShellRenderSettings(): IO365ShellRenderSettings {\r\n    return this._o365ShellRenderSettings;\r\n  }\r\n\r\n  /**\r\n   * Property representing the culture name (e.g. \"en-us\")\r\n   */\r\n  public get currentUICultureName(): string {\r\n    return this._currentUICultureName;\r\n  }\r\n\r\n  /**\r\n   * Represents the web server relative url where we would ping the Suite Nav service.\r\n   */\r\n  public get webServerRelativeUrl(): string {\r\n    return this._webServerRelativeUrl;\r\n  }\r\n\r\n  public get hamburgerCallback(): () => void {\r\n    return this._hamburgerMenuCallback;\r\n  }\r\n\r\n  public set hamburgerCallback(hamburgerCallback: () => void) {\r\n    this._hamburgerMenuCallback = hamburgerCallback;\r\n  }\r\n\r\n  public get suiteNavPostRenderCallback(): () => void {\r\n    return this._suiteNavPostRenderCallback;\r\n  }\r\n\r\n  public set suiteNavPostRenderCallback(suiteNavPostRenderCallback: () => void) {\r\n    this._suiteNavPostRenderCallback = suiteNavPostRenderCallback;\r\n  }\r\n\r\n  private _shouldDisableSuiteNav(): boolean {\r\n    return (window.location.hostname === 'localhost' ||\r\n      this._pageContext.urlQueryParameters.getValue('disableSuiteNav') === 'true') ?\r\n      true :\r\n      false;\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}