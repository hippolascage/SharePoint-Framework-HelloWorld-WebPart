{"version":3,"sources":["local/framework/pageContext/PageContextCore.ts"],"names":[],"mappings":";;;;;;AACA,+BAAmD,2BAA2B,CAAC,CAAA;AAE/E,gCAAsD,mBAAmB,CAAC,CAAA;AA+B1E;;;IAGI;AACJ;IAA6C,mCAAe;IA6B1D,yBAAY,WAAwB;QAClC,kBAAM,WAAW,CAAC,CAAC;IACrB,CAAC;IAED;;;OAGG;IACI,8BAAI,GAAX,UAAY,IAA0B;QACpC,IAAI,CAAC,YAAY,EAAE,CAAC;QAEpB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,kBAAkB,CAAC;QACnD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACvD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,aAAa,CAAC;QAChD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC;QAC3C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC;QACjC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;QACnC,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,sBAAsB,CAAC;QAC3D,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;QACnC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,qBAAqB,CAAC;QACzD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,kBAAkB,CAAC;QACnD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,kBAAkB,CAAC;QACnD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC;QAC3C,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;QACnC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,oBAAoB,CAAC;QACvD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC;QACrC,IAAI,CAAC,aAAa,GAAG,IAAI,6BAAY,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAEzD,IAAI,CAAC,KAAK,GAAG,sCAAoB,CAAC,KAAK,CAAC;IAC1C,CAAC;IAKD,sBAAW,qCAAQ;QAHnB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QACxB,CAAC;;;OAAA;IAKD,sBAAW,+CAAkB;QAH7B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC;QAClC,CAAC;;;OAAA;IAKD,sBAAW,iDAAoB;QAH/B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC;QACpC,CAAC;;;OAAA;IAKD,sBAAW,iDAAoB;QAH/B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC;QACpC,CAAC;;;OAAA;IAKD,sBAAW,2CAAc;QAHzB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;QAC9B,CAAC;;;OAAA;IAKD,sBAAW,sCAAS;QAHpB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACzB,CAAC;;;OAAA;IAKD,sBAAW,uCAAU;QAHrB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;QAC1B,CAAC;;;OAAA;IAKD,sBAAW,uCAAU;QAHrB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;QAC1B,CAAC;;;OAAA;IAKD,sBAAW,mDAAsB;QAHjC;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC;QACtC,CAAC;;;OAAA;IAKD,sBAAW,0CAAa;QAHxB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;;;OAAA;IAKD,sBAAW,4CAAe;QAH1B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC;QAC/B,CAAC;;;OAAA;IAKD,sBAAW,0CAAa;QAHxB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;;;OAAA;IAKD,sBAAW,mCAAM;QAHnB;;aAEK;aACH;YACE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;QACtB,CAAC;;;OAAA;IAKD,sBAAW,kDAAqB;QAHhC;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC;QACrC,CAAC;;;OAAA;IAKD,sBAAW,+CAAkB;QAH7B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC;QAClC,CAAC;;;OAAA;IAKD,sBAAW,0CAAa;QAHxB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;;;OAAA;IAKD,sBAAW,+CAAkB;QAH7B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC;QAClC,CAAC;;;OAAA;IAKD,sBAAW,4CAAe;QAH1B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC;QAC/B,CAAC;;;OAAA;IAKD,sBAAW,0CAAa;QAHxB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;QAC7B,CAAC;;;OAAA;IAKD,sBAAW,2CAAc;QAHzB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;QAC9B,CAAC;;;OAAA;IAKD,sBAAW,kCAAK;QAHhB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACrB,CAAC;;;OAAA;IAKD,sBAAW,uCAAU;QAHrB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;QAC1B,CAAC;;;OAAA;IAKD,sBAAW,iDAAoB;QAH/B;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC;QACpC,CAAC;;;OAAA;IAKD,sBAAW,qCAAQ;QAHnB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QACxB,CAAC;;;OAAA;IAKD,sBAAW,wCAAW;QAHtB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;QAC3B,CAAC;;;OAAA;IAED;;;;OAIG;IACI,wCAAc,GAArB;QACE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;IAC3B,CAAC;IAED;;;;OAIG;IACI,2CAAiB,GAAxB,UAAyB,KAAyB;QAChD,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;IAC5B,CAAC;IAKD,sBAAW,kDAAqB;QAHhC;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;QAC5B,CAAC;;;OAAA;IACH,sBAAC;AAAD,CA7QA,AA6QC,CA7Q4C,yBAAe,GA6Q3D;AA7QD;iCA6QC,CAAA","file":"local/framework/pageContext/PageContextCore.js","sourcesContent":["import ISPPageContextInfo from '../httpClient/odataTypes/ISPPageContextInfo';\r\nimport { SPPermission, IODataBasePermission } from '@microsoft/sp-client-base';\r\nimport PageContext from './AppPageContext';\r\nimport PageContextItem, { PageContextItemState } from './PageContextItem';\r\n\r\nexport interface IPageContextCoreArgs {\r\n  MenuData: Object;\r\n  currentCultureName: string;\r\n  currentUICultureName: string;\r\n  correlationId: string;\r\n  spoEnvironment: string;\r\n  farmLabel: string;\r\n  groupColor: string;\r\n  hasManageWebPermission: boolean;\r\n  layoutsUrl: string;\r\n  listPermsMask: Object;\r\n  siteAbsoluteUrl: string;\r\n  siteClientTag: string;\r\n  siteId: string;\r\n  siteServerRelativeUrl: string;\r\n  siteSubscriptionId: string;\r\n  systemUserKey: string;\r\n  themedCssFolderUrl: string;\r\n  userDisplayName: string;\r\n  userLoginName: string;\r\n  webAbsoluteUrl: string;\r\n  webId: string;\r\n  webLogoUrl: string;\r\n  webServerRelativeUrl: string;\r\n  webTitle: string;\r\n  webTemplate: string;\r\n  webPermMasks: IODataBasePermission;\r\n}\r\n\r\n/**\r\n  * This class is primarily used with the PageContext class.  It provides contextual\r\n  * information for the SharePoint site collection that is hosting the page.\r\n  */\r\nexport default class PageContextCore extends PageContextItem {\r\n  private _menuData: Object;\r\n  private _currentCultureName: string;\r\n  private _currentUICultureName: string;\r\n  private _initialCorrelationId: string;\r\n  private _spoEnvironment: string;\r\n  private _farmLabel: string;\r\n  private _groupColor: string;\r\n  private _hasManageWebPermission: boolean;\r\n  private _layoutsUrl: string;\r\n  private _listPermsMask: Object;\r\n  private _siteAbsoluteUrl: string;\r\n  private _siteClientTag: string;\r\n  private _siteId: string;\r\n  private _siteServerRelativeUrl: string;\r\n  private _siteSubscriptionId: string;\r\n  private _systemUserKey: string;\r\n  private _themedCssFolderUrl: string;\r\n  private _userDisplayName: string;\r\n  private _userLoginName: string;\r\n  private _webAbsoluteUrl: string;\r\n  private _webId: string;\r\n  private _webLogoUrl: string;\r\n  private _webServerRelativeUrl: string;\r\n  private _webTitle: string;\r\n  private _webTemplate: string;\r\n  private _odataObject: ISPPageContextInfo;\r\n  private _webPermMasks: SPPermission;\r\n\r\n  constructor(pageContext: PageContext) {\r\n    super(pageContext);\r\n  }\r\n\r\n  /**\r\n   * Assigns all properties of the object, then assigns the \"state\" property\r\n   * to PageContextItemState.Ready.\r\n   */\r\n  public load(args: IPageContextCoreArgs): void {\r\n    this.validateLoad();\r\n\r\n    this._menuData = args.MenuData;\r\n    this._currentCultureName = args.currentCultureName;\r\n    this._currentUICultureName = args.currentUICultureName;\r\n    this._initialCorrelationId = args.correlationId;\r\n    this._spoEnvironment = args.spoEnvironment;\r\n    this._farmLabel = args.farmLabel;\r\n    this._groupColor = args.groupColor;\r\n    this._hasManageWebPermission = args.hasManageWebPermission;\r\n    this._listPermsMask = args.listPermsMask;\r\n    this._layoutsUrl = args.layoutsUrl;\r\n    this._siteAbsoluteUrl = args.siteAbsoluteUrl;\r\n    this._siteClientTag = args.siteClientTag;\r\n    this._siteServerRelativeUrl = args.siteServerRelativeUrl;\r\n    this._siteSubscriptionId = args.siteSubscriptionId;\r\n    this._siteId = args.siteId;\r\n    this._systemUserKey = args.systemUserKey;\r\n    this._themedCssFolderUrl = args.themedCssFolderUrl;\r\n    this._userDisplayName = args.userDisplayName;\r\n    this._userLoginName = args.userLoginName;\r\n    this._webAbsoluteUrl = args.webAbsoluteUrl;\r\n    this._webId = args.webId;\r\n    this._webLogoUrl = args.webLogoUrl;\r\n    this._webServerRelativeUrl = args.webServerRelativeUrl;\r\n    this._webTitle = args.webTitle;\r\n    this._webTemplate = args.webTemplate;\r\n    this._webPermMasks = new SPPermission(args.webPermMasks);\r\n\r\n    this.state = PageContextItemState.Ready;\r\n  }\r\n\r\n  /**\r\n   * Common menu data that is shared throughout all Sharepoint applications.\r\n   */\r\n  public get menuData(): Object {\r\n    return this._menuData;\r\n  }\r\n\r\n  /**\r\n   * The culture used for rendering date/time components.\r\n   */\r\n  public get currentCultureName(): string {\r\n    return this._currentCultureName;\r\n  }\r\n\r\n  /**\r\n   * The culture used for rendering UI components.\r\n   */\r\n  public get currentUICultureName(): string {\r\n    return this._currentUICultureName;\r\n  }\r\n\r\n  /**\r\n   * The GUID that identifies the CorrelationId of the request.\r\n   */\r\n  public get initialCorrelationId(): string {\r\n    return this._initialCorrelationId;\r\n  }\r\n\r\n  /**\r\n   * The name of the SPO Environment (eDog, MSIT, Prod, ...) for this request.\r\n   */\r\n  public get spoEnvironment(): string {\r\n    return this._spoEnvironment;\r\n  }\r\n\r\n  /**\r\n   * The farm Label for this request. (US_2_Content)\r\n   */\r\n  public get farmLabel(): string {\r\n    return this._farmLabel;\r\n  }\r\n\r\n  /**\r\n   * The group Color (ie \"0xFFFFFF\"\") (only from Group Sites)\r\n   */\r\n  public get groupColor(): string {\r\n    return this._groupColor;\r\n  }\r\n\r\n  /**\r\n   * The relative layout url of the web\r\n   */\r\n  public get layoutsUrl(): string {\r\n    return this._layoutsUrl;\r\n  }\r\n\r\n  /**\r\n   * Indicates if the user has ManageWeb Permissions for the site this request was in.\r\n   */\r\n  public get hasManageWebPermission(): boolean {\r\n    return this._hasManageWebPermission;\r\n  }\r\n\r\n  /**\r\n   * The Mask of list Permissions for the current user in the list of this request.\r\n   */\r\n  public get listPermsMask(): Object {\r\n    return this._listPermsMask;\r\n  }\r\n\r\n  /**\r\n   * The AbsoluteUrl of this request.\r\n   */\r\n  public get siteAbsoluteUrl(): string {\r\n    return this._siteAbsoluteUrl;\r\n  }\r\n\r\n  /**\r\n   * The site's version number of sharepoint.\r\n   */\r\n  public get siteClientTag(): string {\r\n    return this._siteClientTag;\r\n  }\r\n\r\n/**\r\n   * The site's id on sharepoint.\r\n   */\r\n  public get siteId(): string {\r\n    return this._siteId;\r\n  }\r\n\r\n  /**\r\n   * The server relative Url to the SPSite\r\n   */\r\n  public get siteServerRelativeUrl(): string {\r\n    return this._siteServerRelativeUrl;\r\n  }\r\n\r\n  /**\r\n   * The siteSubscriptionId of the Tenant for which this request was made.\r\n   */\r\n  public get siteSubscriptionId(): string {\r\n    return this._siteSubscriptionId;\r\n  }\r\n\r\n  /**\r\n   * The string that represents the unique user.\r\n   */\r\n  public get systemUserKey(): string {\r\n    return this._systemUserKey;\r\n  }\r\n\r\n  /**\r\n   * The url for the themed CSS if this site has a theme appplied, otherwise null.\r\n   */\r\n  public get themedCssFolderUrl(): string {\r\n    return this._themedCssFolderUrl;\r\n  }\r\n\r\n  /**\r\n   * The absolute url to the SPWeb\r\n   */\r\n  public get userDisplayName(): string {\r\n    return this._userDisplayName;\r\n  }\r\n\r\n  /**\r\n   * The absolute url to the SPWeb\r\n   */\r\n  public get userLoginName(): string {\r\n    return this._userLoginName;\r\n  }\r\n\r\n  /**\r\n   * The absolute url to the SPWeb\r\n   */\r\n  public get webAbsoluteUrl(): string {\r\n    return this._webAbsoluteUrl;\r\n  }\r\n\r\n  /**\r\n   * The absolute url to the SPWeb\r\n   */\r\n  public get webId(): string {\r\n    return this._webId;\r\n  }\r\n\r\n  /**\r\n   * The server relative Url to the web Logo\r\n   */\r\n  public get webLogoUrl(): string {\r\n    return this._webLogoUrl;\r\n  }\r\n\r\n  /**\r\n   * The server Relative url to the SPWeb\r\n   */\r\n  public get webServerRelativeUrl(): string {\r\n    return this._webServerRelativeUrl;\r\n  }\r\n\r\n  /**\r\n   * The Title of the Web\r\n   */\r\n  public get webTitle(): string {\r\n    return this._webTitle;\r\n  }\r\n\r\n  /**\r\n   * The site template used to create the web.\r\n   */\r\n  public get webTemplate(): string {\r\n    return this._webTemplate;\r\n  }\r\n\r\n  /**\r\n   * Returns an ODATA object containing additional information for this list, if available.\r\n   * Otherwise, this returns undefined.  If your application fetches this data itself, it\r\n   * can call updateOdataObject() to update the context.\r\n   */\r\n  public getOdataObject(): ISPPageContextInfo {\r\n    return this._odataObject;\r\n  }\r\n\r\n  /**\r\n   * Updates the ODATA object that will be returned when getOdataObject() is called.\r\n   * This allows the application to share its data with other objects (e.g. web parts)\r\n   * to avoid unnecessary REST calls.\r\n   */\r\n  public updateOdataObject(value: ISPPageContextInfo): void {\r\n    this._odataObject = value;\r\n  }\r\n\r\n  /**\r\n   * The permissions mask of the current user on the web.\r\n   */\r\n  public get userPermissionsForWeb(): SPPermission {\r\n    return this._webPermMasks;\r\n  }\r\n}\r\n\r\n"],"sourceRoot":"/src"}