"use strict";
require('office-ui-fabric-react');
var SPThemeProvider_1 = require('./SPThemeProvider');
var sp_client_base_1 = require('@microsoft/sp-client-base');
require('./SPPageChrome.scss');
var SPPageChrome = (function () {
    function SPPageChrome(serviceScope) {
        this._createPageChrome();
        if (!sp_client_base_1.SPKillSwitch.isActivated(sp_client_base_1.Guid.tryParse('48CB5A9D-4E94-40F0-B51F-24480C28E565'), '7/13/2016', 'EnableTheming')) {
            this._spThemeProvider = new SPThemeProvider_1.default(serviceScope);
            this._spThemeProvider.loadThemedStyles();
        }
    }
    SPPageChrome.getInstance = function (serviceScope) {
        if (SPPageChrome._instance === undefined) {
            SPPageChrome._instance = new SPPageChrome(serviceScope);
        }
        return SPPageChrome._instance;
    };
    SPPageChrome.prototype.changeSuiteNavHeight = function (pixels) {
        var top = parseInt(pixels, 10) + 'px';
        this.appDiv.style.top = top;
        this.appDiv.style.height = "calc(100% - " + top + ")";
        this.propertyPaneContainerDiv.style.top = top;
        this.suiteNavDiv.style.height = top;
    };
    /**
     * Creates div elements that are used to render the Standard Page Chrome for
     * Client Side Applications. The structure of the Page Chrome is:
     *
     * SPPageChrome - Parent Div for Client Side Applications
     * -SuiteNav - O365 SuiteNav
     * --App - Div Element where the application will be rendered.
     */
    SPPageChrome.prototype._createPageChrome = function () {
        document.body.className = 'ms-font-m';
        var pageChromeDiv = document.createElement('div');
        pageChromeDiv.setAttribute('class', 'SPPageChrome');
        this.suiteNavDiv = document.createElement('div');
        this.suiteNavDiv.setAttribute('id', 'SuiteNavPlaceHolder');
        this.appDiv = document.createElement('div');
        this.appDiv.setAttribute('class', 'SPPageChrome-app spPageContentTransition');
        this.appDiv.setAttribute('id', 'spPageChromeAppDiv');
        this.propertyPaneContainerDiv = document.createElement('div');
        this.propertyPaneContainerDiv.setAttribute('class', 'spPropertyPaneContainer spPageContentTransition');
        this.propertyPaneContainerDiv.setAttribute('id', 'spPropertyPaneContainer');
        pageChromeDiv.appendChild(this.suiteNavDiv);
        pageChromeDiv.appendChild(this.appDiv);
        pageChromeDiv.appendChild(this.propertyPaneContainerDiv);
        document.body.appendChild(pageChromeDiv);
    };
    return SPPageChrome;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = SPPageChrome;

//# sourceMappingURL=SPPageChrome.js.map
