{"version":3,"sources":["local/common/suiteNav/dataAccess/SPOSuiteNavDataSource.ts"],"names":[],"mappings":"AAAA;;;GAGG;;AAGH,oCAAoD,uBAAuB,CAAC,CAAA;AAC5E,+BAIO,2BAA2B,CAAC,CAAA;AAEnC;IAQE;;;;OAIG;IACH,+BAAY,UAAsB,EAAE,oBAA4B,EAAE,oBAA4B;QAVvF,oBAAe,GAAmB,oCAAc,CAAC,GAAG,CAAC;QAW1D,IAAI,CAAC,qBAAqB,GAAG,oBAAoB,CAAC;QAClD,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;QAC9B,IAAI,CAAC,WAAW,GAAG,oBAAoB,KAAK,GAAG,GAAG,EAAE,GAAG,oBAAoB,CAAC;IAC9E,CAAC;IAED,gDAAgD;IACzC,wCAAQ,GAAf;QACE,IAAM,GAAG,GACP,IAAI,CAAC,WAAW;cACd,yDAAyD;cACzD,IAAI,CAAC,qBAAqB;cAC1B,2BAA2B,CAAC;QAEhC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,EAAE,EAAG,CAAC;aACnC,IAAI,CAAC,UAAC,QAAkB;YACvB,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,KAAK,GAAG,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;gBACvE,6BAAY,CAAC,UAAU,CAAC,qBAAqB,CAAC,UAAU,EAAE,qCAAqC,CAAC,CAAC;gBACjG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,qCAAqC,CAAC,CAAC;YAC/D,CAAC;YACD,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,UAAC,YAA4B;gBACvD,MAAM,CAAC,YAAY,CAAC;YACtB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IApCD,sCAAsC;IACvB,gCAAU,GAAe,2BAAU,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;IAoCrF,4BAAC;AAAD,CAtCA,AAsCC,IAAA;AAtCD;uCAsCC,CAAA","file":"local/common/suiteNav/dataAccess/SPOSuiteNavDataSource.js","sourcesContent":["/**\r\n * @file SPOSuiteNavDataSource.ts\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n */\r\n\r\nimport ISuiteNavModel from '../models/ISuiteNavModel';\r\nimport { ISuiteNavDataSource, SuiteNavSource } from './ISuiteNavDataSource';\r\nimport {\r\n  HttpClient,\r\n  _LogSource,\r\n  _TraceLogger\r\n} from '@microsoft/sp-client-base';\r\n\r\nexport default class SPOSuiteNavDataSource implements ISuiteNavDataSource {\r\n  // @TODO Bug 169685 change to readonly\r\n  private static _logSource: _LogSource = _LogSource.create('SPOSuiteNavDataSource');\r\n  public suiteNavService: SuiteNavSource = SuiteNavSource.SPO;\r\n  private _currentUICultureName: string;\r\n  private _httpClient: HttpClient;\r\n  private _siteRelUrl: string;\r\n\r\n  /**\r\n   * Initializes a new instance of the SPO\r\n   * @TODO Task 161973 Add PageContext and set the\r\n   * webPermissionMask/suiteNavData.UserDisplayName/webServerRelativeUrl/currentUICultureName\r\n   */\r\n  constructor(httpClient: HttpClient, currentUICultureName: string, webServerRelativeUrl: string) {\r\n    this._currentUICultureName = currentUICultureName;\r\n    this._httpClient = httpClient;\r\n    this._siteRelUrl = webServerRelativeUrl === '/' ? '' : webServerRelativeUrl;\r\n  }\r\n\r\n  // Downloads the SPO version of the SuiteNavData\r\n  public loadData(): Promise<ISuiteNavModel> {\r\n    const url: string =\r\n      this._siteRelUrl\r\n      + '/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale='\r\n      + this._currentUICultureName\r\n      + '&v=2&mobilereq=0&msajax=1';\r\n\r\n    return this._httpClient.post(url, { })\r\n      .then((response: Response) => {\r\n        if (response.status !== 200 || response.headers.get('SharePointError')) {\r\n          _TraceLogger.logVerbose(SPOSuiteNavDataSource._logSource, 'Failed to retrieve SPO SuiteNavData');\r\n          return Promise.reject('Failed to retrieve SPO SuiteNavData');\r\n        }\r\n        return response.json().then((jsonResponse: ISuiteNavModel) => {\r\n          return jsonResponse;\r\n        });\r\n      });\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}