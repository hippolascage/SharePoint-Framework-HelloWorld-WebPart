{"version":3,"sources":["local/appBase/components/canvas/canvas/CanvasWebPartHost.ts"],"names":[],"mappings":"AAAA;;;;GAIG;;AAEH,+BAIO,2BAA2B,CAAC,CAAA;AAGnC,wCAA0C,qDAAqD,CAAC,CAAA;AAEhG;;;;GAIG;AACH;IAOE;;OAEG;IACH,2BACE,YAA0B,EAC1B,YAA+E,EAC/E,mBAAgC,EAChC,YAAyB;QAd7B,iBAyDC;QA1CG,IAAI,CAAC,oBAAoB,GAAG,mBAAmB,CAAC;QAChD,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;QAClC,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;QAClC,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;QAElC,IAAI,CAAC,iCAAiC,GAAG,IAAI,CAAC,iCAAiC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE3F,YAAY,CAAC,YAAY,CAAC;YACxB,KAAI,CAAC,YAAY,GAAG,YAAY,CAAC,OAAO,CAAC,sCAAqB,CAAgB,CAAC;QACjF,CAAC,CAAC,CAAC;IACL,CAAC;IAKD,sBAAW,2CAAY;QAHvB;;WAEG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;QAC5B,CAAC;;;OAAA;IAED;;OAEG;IACI,oCAAQ,GAAf,UAAgB,YAAoB;QAClC,EAAE,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC9B,CAAC;IACH,CAAC;IAED;;OAEG;IACI,6DAAiC,GAAxC,UAAyC,KAAgC;QACvE,EAAE,CAAC,CAAC,KAAK,KAAK,mDAAyB,CAAC,YAAY,CAAC,CAAC,CAAC;YACrD;;;eAGG;YACH,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,aAAa,CAAC,uBAAuB,CAAgB,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;QAC9F,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,mDAAyB,CAAC,aAAa,IAAI,KAAK,KAAK,mDAAyB,CAAC,SAAS,CAAC,CAAC,CAAC;YAC9G,IAAI,CAAC,aAAa,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IACH,wBAAC;AAAD,CAzDA,AAyDC,IAAA;AAzDD;mCAyDC,CAAA","file":"local/appBase/components/canvas/canvas/CanvasWebPartHost.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * @file Web part host for the SP Canvas.\r\n */\r\n\r\nimport {\r\n  ServiceScope,\r\n  Environment,\r\n  environmentServiceKey\r\n} from '@microsoft/sp-client-base';\r\n\r\nimport IWebPartHost from '../../../../common/webParts/IWebPartHost';\r\nimport { WebPartConfigurationEvent } from '../../../../common/webParts/PropertyPaneDefinitions';\r\n\r\n/**\r\n * CanvasWebPartHost is the IWebPartHost implementation used by the Canvas. Each Canvas\r\n * will instantiate their own CanvasWebPartHost, which means the web parts are scoped by\r\n * Canvas.\r\n */\r\nexport default class CanvasWebPartHost implements IWebPartHost {\r\n  private _handleCanvasChanged: () => void;\r\n  private _handleResize: (element: HTMLElement, duration: number, margin?: number) => void;\r\n  private _reclaimFocus: () => void;\r\n  private _serviceScope: ServiceScope;\r\n  private _environment: Environment;\r\n\r\n  /**\r\n   * @param handleCanvasChanged - Optional. Callback invoked when web parts are interacted with.\r\n   */\r\n  constructor(\r\n    serviceScope: ServiceScope,\r\n    handleResize: (element: HTMLElement, duration: number, margin?: number) => void,\r\n    handleCanvasChanged?: () => void,\r\n    reclaimFocus?: () => void) {\r\n    this._handleCanvasChanged = handleCanvasChanged;\r\n    this._handleResize = handleResize;\r\n    this._reclaimFocus = reclaimFocus;\r\n    this._serviceScope = serviceScope;\r\n\r\n    this.webPartConfigurationEventCallback = this.webPartConfigurationEventCallback.bind(this);\r\n\r\n    serviceScope.whenFinished(() => {\r\n      this._environment = serviceScope.consume(environmentServiceKey) as Environment;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @see IWebPartHost\r\n   */\r\n  public get serviceScope(): ServiceScope {\r\n    return this._serviceScope;\r\n  }\r\n\r\n  /**\r\n   * @see IWebPartHost\r\n   */\r\n  public setDirty(wpInstanceId: string): void {\r\n    if (this._handleCanvasChanged) {\r\n      this._handleCanvasChanged();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @see IWebPartHost\r\n   */\r\n  public webPartConfigurationEventCallback(event: WebPartConfigurationEvent): void {\r\n    if (event === WebPartConfigurationEvent.OpenComplete) {\r\n      /*\r\n       * Scroll web part back into with a 500ms animation and\r\n       * 44px additional margin (2 * the _VERTICAL_MARGIN property in CanvasZone)\r\n       */\r\n      this._handleResize(document.querySelector('.CanvasZone--selected') as HTMLElement, 500, 44);\r\n    } else if (event === WebPartConfigurationEvent.CloseComplete || event === WebPartConfigurationEvent.LostFocus) {\r\n      this._reclaimFocus();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}