{"version":3,"sources":["local/appBase/components/sp-rte/rte/SPRteConfiguration.ts"],"names":[],"mappings":"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","file":"local/appBase/components/sp-rte/rte/SPRteConfiguration.js","sourcesContent":["/**\r\n * @copyright Microsoft Corporation. All rights reserved.\r\n */\r\n\r\nimport { IRichTextFormat } from './IRichTextFormat';\r\n\r\nimport Strings from '../../sp-canvas/loc/CanvasStrings.resx';\r\n\r\n/**\r\n * Static class for SPRte configuratoion\r\n * Note: We assume all RTE instances share the same configuration by design\r\n * Should this change in the future, we'll need to change this to non-static design\r\n */\r\nexport default class SPRteConfiguration {\r\n  private _supportedFormatsArray: IRichTextFormat[];\r\n  private _formats: Map<string, IRichTextFormat>;\r\n\r\n  constructor() {\r\n    this._supportedFormatsArray = [\r\n      {\r\n        key: 'bold',\r\n        editorKey: 'bold',\r\n        browserKey: 'bold',\r\n\r\n        isBlockStyle: false,\r\n        isLine: false,\r\n        isEditorNative: true,\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'Bold',\r\n          shortcut: 'Ctrl+B',\r\n          title: Strings.FormattingBarBoldButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'italic',\r\n        editorKey: 'italic',\r\n        browserKey: 'italic',\r\n\r\n        isBlockStyle: false,\r\n        isLine: false,\r\n        isEditorNative: true,\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'Italic',\r\n          shortcut: 'Ctrl+I',\r\n          title: Strings.FormattingBarItalicButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'underline',\r\n        editorKey: 'underline',\r\n        browserKey: 'underline',\r\n\r\n        isBlockStyle: false,\r\n        isLine: false,\r\n        isEditorNative: true,\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'Underline',\r\n          shortcut: 'Ctrl+U',\r\n          title: Strings.FormattingBarUnderlineButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'link',\r\n        editorKey: 'link',\r\n\r\n        isBlockStyle: false,\r\n        isLine: false,\r\n        isEditorNative: true,\r\n        masks: ['underline'],\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'Link',\r\n          shortcut: 'Ctrl+K',\r\n          title: Strings.FormattingBarLinkButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'alignLeft',\r\n        editorKey: 'align',\r\n        browserKey: 'justifyLeft',\r\n\r\n        isBlockStyle: false,\r\n        isLine: true,\r\n        isEditorNative: true,\r\n        editorValue: 'left',\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'AlignLeft',\r\n          title: Strings.FormattingBarAlignLeftButtonTitle\r\n        }\r\n      },\r\n      {\r\n        browserKey: 'justifyCenter',\r\n        key: 'alignCenter',\r\n        editorKey: 'align',\r\n\r\n        isBlockStyle: false,\r\n        isLine: true,\r\n        isEditorNative: true,\r\n        editorValue: 'center',\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'AlignCenter',\r\n          title: Strings.FormattingBarAlignCenterButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'alignRight',\r\n        editorKey: 'align',\r\n        browserKey: 'justifyRight',\r\n\r\n        isBlockStyle: false,\r\n        isLine: true,\r\n        isEditorNative: true,\r\n        editorValue: 'right',\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'AlignRight',\r\n          title: Strings.FormattingBarAlignRightButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'bullet',\r\n        editorKey: 'bullet',\r\n        browserKey: 'insertUnorderedList',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: true,\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'BulletedList',\r\n          title: Strings.FormattingBarBulletListButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'list',\r\n        editorKey: 'list',\r\n        browserKey: 'insertOrderedList',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: true,\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          fabricIconKey: 'NumberedList',\r\n          title: Strings.FormattingBarNumberedListButtonTitle\r\n        }\r\n      },\r\n      {\r\n        key: 'h2',\r\n        editorKey: 'h2',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: false,\r\n        masks: ['bold', 'italic', 'underline'],\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          title: Strings.FormattingBarHeading2ButtonTitle,\r\n          label: Strings.FormattingBarHeading2ButtonTitle,\r\n          className: 'ToolbarButton--h2'\r\n        }\r\n      },\r\n      {\r\n        key: 'h3',\r\n        editorKey: 'h3',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: false,\r\n        masks: ['bold', 'italic', 'underline'],\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          title: Strings.FormattingBarHeading3ButtonTitle,\r\n          label: Strings.FormattingBarHeading3ButtonTitle,\r\n          className: 'ToolbarButton--h3'\r\n        }\r\n      },\r\n      {\r\n        key: 'h4',\r\n        editorKey: 'h4',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: false,\r\n        masks: ['bold', 'italic', 'underline'],\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          title: Strings.FormattingBarHeading4ButtonTitle,\r\n          label: Strings.FormattingBarHeading4ButtonTitle,\r\n          className: 'ToolbarButton--h4'\r\n        }\r\n      },\r\n      {\r\n        key: 'blockquote',\r\n        editorKey: 'blockquote',\r\n\r\n        isBlockStyle: true,\r\n        isLine: true,\r\n        isEditorNative: false,\r\n        masks: ['bold', 'italic', 'underline', 'alignLeft', 'alignCenter', 'alignRight'],\r\n\r\n        button: {\r\n          canBeActive: true,\r\n          title: Strings.FormattingBarQuoteButtonTitle,\r\n          label: Strings.FormattingBarQuoteButtonTitle,\r\n          className: 'ToolbarButton--blockquote'\r\n        }\r\n      }\r\n    ];\r\n\r\n    // Build a map to look up formats by their key quickly\r\n    this._formats = new Map<string, IRichTextFormat>();\r\n    for (const format of this._supportedFormatsArray) {\r\n      this._formats.set(format.key, format);\r\n    }\r\n\r\n    // Populate 'maskedBy' field of all formats based on 'masks' fields\r\n    const maskingFormats: IRichTextFormat[] =\r\n      this._supportedFormatsArray.filter((format) => { return !!format.masks; });\r\n\r\n    for (const maskingFormat of maskingFormats) {\r\n      for (const maskedFormatKey of maskingFormat.masks) {\r\n        const maskedFormat: IRichTextFormat = this._formats.get(maskedFormatKey);\r\n        if (!maskedFormat.maskedBy) {\r\n          maskedFormat.maskedBy = [maskingFormat.key];\r\n        } else {\r\n          maskedFormat.maskedBy.push(maskingFormat.key);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public get formats(): Map<string, IRichTextFormat> {\r\n    return this._formats;\r\n  }\r\n\r\n  public get supportedFormatsArray(): IRichTextFormat[] {\r\n    return this._supportedFormatsArray;\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}