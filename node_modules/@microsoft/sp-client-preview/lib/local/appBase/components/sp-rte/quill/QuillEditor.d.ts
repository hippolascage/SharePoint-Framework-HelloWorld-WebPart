/**
 * @copyright Microsoft Corporation. All rights reserved.
 */
import { IBounds } from '../rte/IBounds';
import { IRange } from '../rte/IRange';
import { IRichTextFormat } from '../rte/IRichTextFormat';
import { IRichTextEditor } from '../rte/IRichTextEditor';
import { IRichTextEditorLoader } from '../rte/IRichTextEditorLoader';
import SPRteConfiguration from '../rte/SPRteConfiguration';
/**
 * Implmentation of ISPRteQuillIntegration for Quill 0.20.1
 */
export default class QuillEditor implements IRichTextEditor {
    static moduleLoader: IRichTextEditorLoader;
    private static quillDelta;
    private static quillDocument;
    private _config;
    private _editorElement;
    private _quill;
    private _quillEditorElement;
    private _handleSelectionChange;
    private _handleTextChange;
    /**
     * @return Promise of the instance that resolves once the editor is loaded on the element
     *
     * Static wrapper for constructing an instance
     */
    static createNewEditor(config: SPRteConfiguration, currentHTML: string, editorElement: HTMLDivElement, selectionChangeCallback: (range: IRange) => void, textChangeCallback: () => void): Promise<QuillEditor>;
    /**
     * Use createNewEditor instead of constructor to ensure using the editor after it's loaded
     * Note: TypeScript doesn't allow private constructors
     */
    constructor(config: SPRteConfiguration, currentHTML: string, editorElement: HTMLDivElement, selectionChangeCallback: (range: IRange) => void, textChangeCallback: () => void);
    destroy(): string;
    /**
     * @param start - Start position of selection
     * @param end - End position of selection
     * @param formats - Map of key:value pairs for formats to apply
     * @param applyAllFormatsToLine - Forces all formats to be applied to the whole line(s). If not provided,
     * formats are divided into two buckets (line vs non-line) based on their isLine field
     *
     * A unified method for applying Quill formats to any selection
     */
    format(start: number, end: number, formats: Object, applyAllFormatsToLine?: boolean): void;
    getBounds(position: number): IBounds;
    getSelection(): IRange;
    getText(range?: IRange): string;
    getHTML(): string;
    getFormatValue(start: number, end: number, format: IRichTextFormat): boolean | string;
    /**
     * @param format - Name of the format to apply from QUILL_FORMATS or SPRTE_FORMATS
     * @param start - Start value of range
     * @param end - End value of range
     *
     * @return A dictionary of string=>boolean indicating if the format is applied to the given range
     */
    isFormatAppliedToRange(start: number, end: number, format: IRichTextFormat): boolean;
    setSelection(range: IRange): void;
    focus(): void;
    private _findWrappingElementByTagName(position, tagName);
    /**
     * @param start - start value of a selection
     * @param end - end value of a selection
     *
     * Find and calculate all the non-sequential formattings in a selection.
     *
     * @return A dictionary mapping of format to non-sequential occurrences in the range of start to end
     */
    private _getActiveFormatsInRange(start, end, isLine?);
    /**
     * Initialize Quill with whitelist of formats, prevent default css,
     * add custom formats, and registering event handlers.
     */
    private _initialize(currentHTML);
}
