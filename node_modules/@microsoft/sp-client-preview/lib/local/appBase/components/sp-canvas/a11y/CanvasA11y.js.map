{"version":3,"sources":["local/appBase/components/sp-canvas/a11y/CanvasA11y.ts"],"names":[],"mappings":"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","file":"local/appBase/components/sp-canvas/a11y/CanvasA11y.js","sourcesContent":["import  { KeyboardEvent as ReactKeyboardEvent } from 'react';\r\n\r\nexport enum KeyCodes {\r\n  Enter = 13,\r\n  Escape = 27,\r\n  Tab = 9,\r\n  F10 = 121,\r\n  P = 80\r\n}\r\n\r\nexport function isEscape(e: KeyboardEvent | ReactKeyboardEvent): boolean {\r\n  return isKey(KeyCodes.Escape, e);\r\n}\r\n\r\nexport function isEnter(e: KeyboardEvent | ReactKeyboardEvent): boolean {\r\n  return isKey(KeyCodes.Enter, e);\r\n}\r\n\r\nexport function isShiftTab(e: KeyboardEvent | ReactKeyboardEvent): boolean {\r\n  return isKey(KeyCodes.Tab, e, false, false, true);\r\n}\r\n\r\nexport function isTab(e: KeyboardEvent | ReactKeyboardEvent): boolean {\r\n  return isKey(KeyCodes.Tab, e);\r\n}\r\n\r\nexport function isKey(\r\n    keyCode: number, e: KeyboardEvent | ReactKeyboardEvent,\r\n    allowAlt: boolean = false,\r\n    allowCtrl: boolean = false,\r\n    allowShift: boolean = false\r\n  ): boolean {\r\n    return e.keyCode === keyCode &&\r\n      ((allowAlt && e.altKey) || (!allowAlt && !e.altKey)) &&\r\n      ((allowCtrl && e.ctrlKey) || (!allowCtrl && !e.ctrlKey)) &&\r\n      ((allowShift && e.shiftKey) || (!allowShift && !e.shiftKey));\r\n}\r\n\r\nexport function getFocusableChildren(elem: HTMLElement, ignoreTabIndex: boolean = false): HTMLElement[] {\r\n  const children: HTMLElement[] = [];\r\n  for (const descendant of getFocusableDescendants(elem, ignoreTabIndex)) {\r\n    if (isElementFocusableChildOf(descendant, elem)) {\r\n      children.push(descendant);\r\n    }\r\n  }\r\n  return children;\r\n}\r\n\r\nexport function isElementFocusable(elem: HTMLElement, ignoreTabIndex: boolean = false): boolean {\r\n  const tagName: string = elem.tagName.toLowerCase();\r\n\r\n  if (elem && !elem.hidden && window.getComputedStyle(elem).display !== 'none') {\r\n    const hasTabIndex: boolean = elem.hasAttribute('tabindex');\r\n    const tabindex: number = parseInt(elem.getAttribute('tabindex'), 10);\r\n\r\n    if (!ignoreTabIndex && hasTabIndex && tabindex < 0) {\r\n      return false;\r\n    }\r\n\r\n    if (\r\n      tagName === 'a' && !!(elem as HTMLAnchorElement).href ||\r\n      elem.isContentEditable\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    if (\r\n      (\r\n        tagName === 'button' ||\r\n        tagName === 'input' ||\r\n        tagName === 'select' ||\r\n        tagName === 'textarea'\r\n      ) && !(elem as HTMLButtonElement).disabled\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    if (!ignoreTabIndex && hasTabIndex && tabindex > -1) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function getFocusableParent(elem: HTMLElement, topElement: HTMLElement = document.body): HTMLElement {\r\n  let parent: HTMLElement = elem;\r\n\r\n  do {\r\n    parent = parent.parentElement;\r\n  } while (!isElementFocusable(parent) && !parent.isEqualNode(topElement));\r\n\r\n  return parent;\r\n}\r\n\r\nfunction queryFocusableSelector(elem: HTMLElement): NodeList {\r\n  const selector: string =\r\n    'button,input,textarea,select,a[href]:not([href=\\'\\']),\\\r\n      [tabindex],[contenteditable=\\'true\\']';\r\n  return elem.querySelectorAll(selector);\r\n}\r\n\r\nexport function getFirstFocusableChild(elem: HTMLElement, ignoreTabIndex: boolean = false): HTMLElement {\r\n  const nodes: NodeList = queryFocusableSelector(elem);\r\n  for (let i: number = 0; i < nodes.length; i++) {\r\n    const node: HTMLElement = nodes[i] as HTMLElement;\r\n    if (isElementFocusable(node, ignoreTabIndex)) {\r\n      return node;\r\n    }\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport function getFocusableDescendants(elem: HTMLElement, ignoreTabIndex: boolean = false): HTMLElement[] {\r\n  const descendants: HTMLElement[] = [];\r\n  const nodes: NodeList = queryFocusableSelector(elem);\r\n  for (let i: number = 0; i < nodes.length; i++) {\r\n    const node: HTMLElement = nodes[i] as HTMLElement;\r\n    if (isElementFocusable(node, ignoreTabIndex)) {\r\n      descendants.push(node);\r\n    }\r\n  }\r\n  return descendants;\r\n}\r\n\r\nexport function getFocusableSiblings(elem: HTMLElement, topElement: HTMLElement = document.body): HTMLElement[] {\r\n  const children: HTMLElement[] = getFocusableChildren(getFocusableParent(elem, topElement));\r\n  // Remove input element and start the list from its next sibling\r\n  const siblings: HTMLElement[] = [];\r\n  let insertPointer: number = 0;\r\n  for (const child of children) {\r\n    if (!child.isEqualNode(elem)) {\r\n      siblings.splice(insertPointer++, 0, child);\r\n    } else {\r\n      insertPointer = 0;\r\n    }\r\n  }\r\n  return siblings;\r\n}\r\n\r\nexport function getNextFocusableElement(elem: HTMLElement, topElement: HTMLElement = document.body): HTMLElement {\r\n  const siblings: HTMLElement[] = getFocusableSiblings(elem, topElement);\r\n  return siblings[0];\r\n}\r\n\r\nexport function getPrevFocusableElement(elem: HTMLElement, topElement: HTMLElement = document.body): HTMLElement {\r\n  const siblings: HTMLElement[] = getFocusableSiblings(elem, topElement);\r\n  return siblings[siblings.length - 1];\r\n}\r\n\r\nexport function isElementFocusableChildOf(elem: HTMLElement, ancestor: HTMLElement): boolean {\r\n  let parent: HTMLElement = elem.parentElement;\r\n\r\n  while (parent.tagName !== 'BODY') {\r\n    if (parent.isEqualNode(ancestor)) {\r\n      return true;\r\n    }\r\n    if (isElementFocusable(parent)) {\r\n      break;\r\n    }\r\n    parent = parent.parentElement;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function navigateInside(elem: HTMLElement): boolean {\r\n  const children: HTMLElement[] = getFocusableChildren(elem);\r\n  if (children.length) {\r\n    children[0].focus();\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function navigateTo(elem: HTMLElement): boolean {\r\n  if (isElementFocusable(elem)) {\r\n    elem.focus();\r\n    return true;\r\n  } else {\r\n    return navigateInside(elem);\r\n  }\r\n}\r\n\r\nexport function navigateOutOf(elem: HTMLElement, topElement: HTMLElement = document.body): void {\r\n  topElement = topElement || document.body;\r\n  getFocusableParent(elem, topElement).focus();\r\n}\r\n\r\nexport class CanvasA11yManager {\r\n  public static _SKIP_FLAG: string = 'a11y-skip';\r\n\r\n  private _canvasElement: HTMLElement;\r\n  private _randId: number;\r\n  private _savedFocusedElement: HTMLElement;\r\n\r\n  public constructor(canvasElement: HTMLElement, shouldHandleKeyDown: boolean = true) {\r\n    this._canvasElement = canvasElement;\r\n    this._handleKeyDown = this._handleKeyDown.bind(this);\r\n    this._randId = Math.floor(Math.random() * 1000000);\r\n\r\n    if (shouldHandleKeyDown) {\r\n      this._canvasElement.addEventListener('keydown', this._handleKeyDown);\r\n    }\r\n  }\r\n\r\n  public ariaAlert(message: string): void {\r\n    const divId: string = 'aria_alert_' + this._randId;\r\n    const oldAlert: HTMLElement = document.querySelector('#' + divId) as HTMLElement;\r\n    if (oldAlert) {\r\n      document.body.removeChild(oldAlert);\r\n    }\r\n\r\n    const alertNode: HTMLElement = document.createElement('p');\r\n    alertNode.classList.add('Canvas-screenReaderOnly');\r\n    alertNode.setAttribute('role', 'alert');\r\n    alertNode.setAttribute('id', divId);\r\n    const alertText: Node = document.createTextNode(message);\r\n    alertNode.appendChild(alertText);\r\n    document.body.appendChild(alertNode);\r\n  }\r\n\r\n  public navigateInside(elem: HTMLElement): boolean {\r\n    return navigateInside(elem);\r\n  }\r\n\r\n  public navigateTo(elem: HTMLElement): boolean {\r\n    return navigateTo(elem);\r\n  }\r\n\r\n  public navigateOutOf(elem: HTMLElement): void {\r\n    navigateOutOf(elem);\r\n  }\r\n\r\n  public clearState(): void {\r\n    this._savedFocusedElement = undefined;\r\n  }\r\n\r\n  public restoreState(): boolean {\r\n    return this.navigateTo(this._savedFocusedElement);\r\n  }\r\n\r\n  public saveState(elem?: HTMLElement): void {\r\n    elem = elem || document.activeElement as HTMLElement;\r\n    this._savedFocusedElement = elem;\r\n  }\r\n\r\n  public skipEvent(e: KeyboardEvent): void {\r\n    (e as Object)[CanvasA11yManager._SKIP_FLAG] = true;\r\n  }\r\n\r\n  private _shouldSkipEvent(e: KeyboardEvent): boolean {\r\n    return (e as Object)[CanvasA11yManager._SKIP_FLAG] as boolean;\r\n  }\r\n\r\n  private _handleKeyDown(e: KeyboardEvent): void {\r\n    if (this._shouldSkipEvent(e)) {\r\n      return;\r\n    }\r\n\r\n    const currentElement: HTMLElement = isElementFocusable(e.target as HTMLElement) ?\r\n      e.target as HTMLElement : getFocusableParent(e.target as HTMLElement, this._canvasElement);\r\n\r\n    let elementToGo: HTMLElement;\r\n    if (isTab(e)) {\r\n      const children: HTMLElement[] = getFocusableChildren(this._canvasElement);\r\n      if (children.length && !currentElement.isEqualNode(children[children.length - 1])) {\r\n        elementToGo = getNextFocusableElement(currentElement, this._canvasElement);\r\n      }\r\n    } else if (isShiftTab(e)) {\r\n      const children: HTMLElement[] = getFocusableChildren(this._canvasElement);\r\n      if (children.length && !currentElement.isEqualNode(children[0])) {\r\n        elementToGo = getPrevFocusableElement(currentElement, this._canvasElement);\r\n      }\r\n    } else if (isEnter(e)) {\r\n      const children: HTMLElement[] = getFocusableChildren(currentElement);\r\n      elementToGo = children.length ? children[0] : undefined;\r\n    } else if (isEscape(e)) {\r\n      elementToGo = getFocusableParent(currentElement, this._canvasElement);\r\n    }\r\n\r\n    if (elementToGo) {\r\n      elementToGo.focus();\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}