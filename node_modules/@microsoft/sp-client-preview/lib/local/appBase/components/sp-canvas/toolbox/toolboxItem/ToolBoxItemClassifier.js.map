{"version":3,"sources":["local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolBoxItemClassifier.ts"],"names":[],"mappings":"AAAA;;;;GAIG;;AAIH,IAAM,iBAAiB,GAAkB;IACrC,sCAAsC;IACtC,sCAAsC;IACtC,sCAAsC;IACtC,sCAAsC;IACtC,sCAAsC,CAAE,sBAAsB;CACjE,CAAC;AAEF,IAAM,eAAe,GAAW,sCAAsC,CAAC;AAEvE;;GAEG;AACH;IAGE;;OAEG;IACH;QANF,iBAyDC;QAlDG,IAAI,CAAC,wBAAwB,GAAG,IAAI,GAAG,EAA+B,CAAC;QACvE,iBAAiB,CAAC,OAAO,CAAC,UAAC,EAAU;YACnC,KAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,eAAe,EAAE,EAAE,CAAC,CAAC;IACzD,CAAC;IAED;;;;OAIG;IACI,4CAAY,GAAnB,UAAoB,MAAc,EAAE,SAA4B;QAC9D,IAAM,mBAAmB,GAA6B,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAChG,EAAE,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;YACvC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACtC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,4DAA4D;YAC5D,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACrE,CAAC;IACH,CAAC;IAED;;;;;OAKG;IACI,wCAAQ,GAAf,UACE,UAAmB,EACnB,aAAsE;QAEtE,IAAI,gBAAgB,GAA6B,EAAE,CAAC;QACpD,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACf,IAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC,UAAC,KAA0B,EAAE,EAAU;gBAC3E,EAAE,CAAC,CAAC,EAAE,KAAK,eAAe,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;oBAC/C,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClC,CAAC;YACH,CAAC,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QACxE,CAAC;QAED,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAC3B,gBAAgB,GAAG,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAC1D,CAAC;QAED,MAAM,CAAC,gBAAgB,CAAC;IAC1B,CAAC;IACH,4BAAC;AAAD,CAzDA,AAyDC,IAAA;AAzDD;uCAyDC,CAAA","file":"local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolBoxItemClassifier.js","sourcesContent":["/**\r\n * @Copyright (c) Microsoft Corporation.  All rights reserved.\r\n *\r\n * @file Classifies ToolBox items into Featured and NonFeatured items\r\n */\r\n\r\nimport { IToolboxItemProps } from './IToolboxItem';\r\n\r\nconst FEATURED_ITEM_IDS: Array<string> = [\r\n    'd1d91016-032f-456d-98a4-721247c305e8', // Image\r\n    'b7dd04e1-19ce-4b24-9132-b60a1c2b910d', // Document\r\n    '275c0095-a77e-4f6d-a2a0-6a7626911518', // Office 365 video\r\n    '490d7c76-1824-45b2-9de3-676421c997fa', // Embed\r\n    'daf0b71c-6de8-4ef7-b511-faae7c388708'  // Highlighted content\r\n];\r\n\r\nconst GENERIC_ITEM_ID: string = '00000000-0000-0000-0000-000000000000';\r\n\r\n/**\r\n * ToolBoxItemClassifier classifies tool box items into Featured and non-featured\r\n */\r\nexport default class ToolBoxItemClassifier {\r\n  private _toolBoxItemIdToPropsMap: Map<string, IToolboxItemProps[]>;\r\n\r\n  /**\r\n   * Initializes a new instance of the ToolBoxItemClassifier\r\n   */\r\n  constructor() {\r\n    this._toolBoxItemIdToPropsMap = new Map<string, IToolboxItemProps[]>();\r\n    FEATURED_ITEM_IDS.forEach((id: string) => {\r\n      this._toolBoxItemIdToPropsMap.set(id, []);\r\n    });\r\n\r\n    this._toolBoxItemIdToPropsMap.set(GENERIC_ITEM_ID, []);\r\n  }\r\n\r\n  /**\r\n   * Registers a new item with the Classifier\r\n   * @param itemId represents the item Id\r\n   * @param itemProps represents the item properties\r\n   */\r\n  public registerItem(itemId: string, itemProps: IToolboxItemProps): void {\r\n    const registeredItemProps: Array<IToolboxItemProps> = this._toolBoxItemIdToPropsMap.get(itemId);\r\n    if (Array.isArray(registeredItemProps)) {\r\n      registeredItemProps.push(itemProps);\r\n    } else {\r\n      // If not registered, then place item in generic item bucket\r\n      this._toolBoxItemIdToPropsMap.get(GENERIC_ITEM_ID).push(itemProps);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets items classified by a specific type\r\n   * @param isFeatured determines the classification type\r\n   * @param sortPredicate is optional sorting predicate\r\n   * @returns items classified by a particular type\r\n   */\r\n  public classify(\r\n    isFeatured: boolean,\r\n    sortPredicate?: (x: IToolboxItemProps, y: IToolboxItemProps) => number): Array<IToolboxItemProps> {\r\n\r\n    let toolBoxItemProps: Array<IToolboxItemProps> = [];\r\n    if (isFeatured) {\r\n      this._toolBoxItemIdToPropsMap.forEach((items: IToolboxItemProps[], id: string) => {\r\n        if (id !== GENERIC_ITEM_ID && items.length > 0) {\r\n          toolBoxItemProps.push(items[0]);\r\n        }\r\n      });\r\n    } else {\r\n      toolBoxItemProps = this._toolBoxItemIdToPropsMap.get(GENERIC_ITEM_ID);\r\n    }\r\n\r\n    if (Boolean(sortPredicate)) {\r\n      toolBoxItemProps = toolBoxItemProps.sort(sortPredicate);\r\n    }\r\n\r\n    return toolBoxItemProps;\r\n  }\r\n}\r\n"],"sourceRoot":"/src"}