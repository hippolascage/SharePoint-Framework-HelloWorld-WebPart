{"version":3,"sources":["components/DocumentCard/DocumentCardTitle.tsx"],"names":[],"mappings":";;;;;;AAAA,IAAY,KAAK,WAAM,OAAO,CAAC,CAAA;AAE/B,2BAA2B,uCAAuC,CAAC,CAAA;AACnE,QAAO,0BAA0B,CAAC,CAAA;AAOlC,IAAM,oBAAoB,GAAG,UAAU,CAAC;AACxC,IAAM,yBAAyB,GAAG,EAAE,CAAC;AACrC,IAAM,yBAAyB,GAAG,EAAE,GAAG,oBAAoB,CAAC,MAAM,CAAC;AACnE,IAAM,gCAAgC,GAAG,EAAE,CAAC;AAC5C,IAAM,sCAAsC,GAAG,CAAC,CAAC;AAEjD;IAAuC,qCAAiE;IAUtG,2BAAY,KAA8B;QACxC,kBAAM,KAAK,CAAC,CAAC;QAEb,IAAI,CAAC,KAAK,GAAG;YACX,wBAAwB,EAAG,EAAE;YAC7B,yBAAyB,EAAE,EAAE;SAC9B,CAAC;QAEF,IAAI,CAAC,OAAO,GAAG,IAAI,uBAAU,CAAC,IAAI,CAAC,CAAC;QAEpC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC3D,CAAC;IAEM,6CAAiB,GAAxB;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAC5D,CAAC;IACH,CAAC;IAEM,gDAAoB,GAA3B;QACE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAEM,qDAAyB,GAAhC,UAAiC,QAAiC;QAChE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;YACvE,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC1B,CAAC;IACH,CAAC;IAEM,8CAAkB,GAAzB;QACE,gDAAgD;QAChD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;IACH,CAAC;IAEM,kCAAM,GAAb;QACE,IAAA,eAA0C,EAApC,gBAAK,EAAE,kCAAc,CAAgB;QAC3C,IAAA,eAAwE,EAAlE,sDAAwB,EAAE,wDAAyB,CAAgB;QAEzE,IAAI,iBAAiB,CAAC;QACtB,EAAE,CAAC,CAAC,cAAc,IAAI,CAAC,wBAAwB,IAAI,yBAAyB,CAAC,CAAC,CAAC,CAAC;YAC9E,iBAAiB,GAAG,CAClB,qBAAC,GAAG,IAAC,SAAS,EAAC,sBAAsB,EAAC,GAAG,EAAC,cAAc,EAAC,KAAK,EAAG,KAAO,GAAG,wBAA0B,OAAU,yBAA2B,CAAM,CACjJ,CAAC;QACJ,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,iBAAiB,GAAG,CAClB,qBAAC,GAAG,IAAC,SAAS,EAAC,sBAAsB,EAAC,GAAG,EAAC,cAAc,EAAC,KAAK,EAAG,KAAO,GAAG,KAAO,CAAM,CACzF,CAAC;QACJ,CAAC;QAED,MAAM,CAAC,CACL,qBAAC,GAAG,SACA,iBAAmB,CACjB,CACP,CAAC;IACJ,CAAC;IAEO,4CAAgB,GAAxB;QACE,IAAI,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QAErC,+DAA+D;QAC/D,EAAE,CAAC,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,IAAI,yBAAyB,CAAC,CAAC,CAAC;YAEvE,oDAAoD;YACpD,EAAE,CAAC,CAAC,aAAa,CAAC,MAAM,GAAG,yBAAyB,CAAC,CAAC,CAAC;gBACrD,qHAAqH;gBACrH,IAAI,CAAC,QAAQ,CAAC;oBACZ,wBAAwB,EAAG,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,yBAAyB,GAAG,CAAC,GAAG,gCAAgC,CAAC;oBACnH,yBAAyB,EAAG,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,yBAAyB,GAAG,CAAC,GAAG,gCAAgC,CAAC,CAAC;iBAC3I,CAAC,CAAC;YACL,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,kEAAkE;gBAClE,IAAI,CAAC,QAAQ,CAAC;oBACZ,wBAAwB,EAAG,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,gCAAgC,CAAC;oBACzH,yBAAyB,EAAG,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,gCAAgC,CAAC;iBAChJ,CAAC,CAAC;YACL,CAAC;QACH,CAAC;QAED,0GAA0G;QAC1G,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;IAEnE,CAAC;IAEO,wCAAY,GAApB;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAC;YAC9B,IAAA,eAAwE,EAAlE,sDAAwB,EAAE,wDAAyB,CAAgB;YACzE,IAAI,CAAC,QAAQ,CAAC;gBACZ,wBAAwB,EAAG,wBAAwB,CAAC,KAAK,CAAC,CAAC,EAAE,wBAAwB,CAAC,MAAM,GAAG,CAAC,CAAC;gBACjG,yBAAyB,EAAG,yBAAyB,CAAC,KAAK,CAAC,CAAC,CAAC;aAC/D,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAEO,8CAAkB,GAA1B;QACE,IAAI,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;QAC1C,MAAM,CAAC,YAAY,CAAC,YAAY,GAAG,YAAY,CAAC,YAAY,GAAG,sCAAsC,IAAI,YAAY,CAAC,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC;IAC/J,CAAC;IAEO,6CAAiB,GAAzB;QACE,0FAA0F;QAC1F,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,KAAK,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC;YACvE,uEAAuE;YACvE,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAClC,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAC;QAC/D,CAAC;IACH,CAAC;IAEH,wBAAC;AAAD,CAxHA,AAwHC,CAxHsC,KAAK,CAAC,SAAS,GAwHrD;AAxHY,yBAAiB,oBAwH7B,CAAA","file":"components/DocumentCard/DocumentCardTitle.js","sourcesContent":["import * as React from 'react';\nimport { IDocumentCardTitleProps } from './DocumentCard.Props';\nimport { EventGroup } from '../../utilities/eventGroup/EventGroup';\nimport './DocumentCardTitle.scss';\n\nexport interface IDocumentCardTitleState {\n  truncatedTitleFirstPiece?: string;\n  truncatedTitleSecondPiece?: string;\n}\n\nconst TRUNCATION_SEPARATOR = '&hellip;';\nconst TRUNCATION_MINIMUM_LENGTH = 40;\nconst TRUNCATION_MAXIMUM_LENGTH = 90 - TRUNCATION_SEPARATOR.length;\nconst TRUNCATION_FIRST_PIECE_LONGER_BY = 10;\nconst TRUNCATION_VERTICAL_OVERFLOW_THRESHOLD = 5;\n\nexport class DocumentCardTitle extends React.Component<IDocumentCardTitleProps, IDocumentCardTitleState> {\n  public refs: {\n    [key: string]: React.ReactInstance;\n    titleElement: HTMLElement;\n  };\n\n  private _events: EventGroup;\n  private _scrollTimerId: number;\n  private _truncatedTitleAtWidth: number;\n\n  constructor(props: IDocumentCardTitleProps) {\n    super(props);\n\n    this.state = {\n      truncatedTitleFirstPiece : '',\n      truncatedTitleSecondPiece: ''\n    };\n\n    this._events = new EventGroup(this);\n\n    this._startTruncation = this._startTruncation.bind(this);\n  }\n\n  public componentDidMount() {\n    if (this.props.shouldTruncate) {\n      this._startTruncation();\n      this._events.on(window, 'resize', this._updateTruncation);\n    }\n  }\n\n  public componentWillUnmount() {\n    this._events.dispose();\n  }\n\n  public componentWillReceiveProps(newProps: IDocumentCardTitleProps) {\n    if ((newProps.title !== this.props.title) && this.props.shouldTruncate) {\n      this._startTruncation();\n    }\n  }\n\n  public componentDidUpdate() {\n    // If we're truncating, make sure the title fits\n    if (this.props.shouldTruncate) {\n      this._shrinkTitle();\n    }\n  }\n\n  public render() {\n    let { title, shouldTruncate } = this.props;\n    let { truncatedTitleFirstPiece, truncatedTitleSecondPiece } = this.state;\n\n    let documentCardTitle;\n    if (shouldTruncate && (truncatedTitleFirstPiece || truncatedTitleSecondPiece)) {\n      documentCardTitle = (\n        <div className='ms-DocumentCardTitle' ref='titleElement' title={ title }>{ truncatedTitleFirstPiece }&hellip;{ truncatedTitleSecondPiece }</div>\n      );\n    } else {\n      documentCardTitle = (\n        <div className='ms-DocumentCardTitle' ref='titleElement' title={ title }>{ title }</div>\n      );\n    }\n\n    return (\n      <div>\n        { documentCardTitle }\n      </div>\n    );\n  }\n\n  private _startTruncation() {\n    let originalTitle = this.props.title;\n\n    // If the title is really short, there's no need to truncate it\n    if (originalTitle && originalTitle.length >= TRUNCATION_MINIMUM_LENGTH) {\n\n      // Break the text into two pieces for assembly later\n      if (originalTitle.length > TRUNCATION_MAXIMUM_LENGTH) {\n        // The text is really long, so we can take a chunk out of the middle so the two pieces combine for the maximum length\n        this.setState({\n          truncatedTitleFirstPiece : originalTitle.slice(0, TRUNCATION_MAXIMUM_LENGTH / 2 + TRUNCATION_FIRST_PIECE_LONGER_BY),\n          truncatedTitleSecondPiece : originalTitle.slice(originalTitle.length - (TRUNCATION_MAXIMUM_LENGTH / 2 - TRUNCATION_FIRST_PIECE_LONGER_BY))\n        });\n      } else {\n        // The text is not so long, so we'll just break it into two pieces\n        this.setState({\n          truncatedTitleFirstPiece : originalTitle.slice(0, Math.ceil(originalTitle.length / 2) + TRUNCATION_FIRST_PIECE_LONGER_BY),\n          truncatedTitleSecondPiece : originalTitle.slice(originalTitle.length - Math.floor(originalTitle.length / 2) + TRUNCATION_FIRST_PIECE_LONGER_BY)\n        });\n      }\n    }\n\n    // Save the width we just started truncation at, so that later we will only update truncation if necessary\n    this._truncatedTitleAtWidth = this.refs.titleElement.clientWidth;\n\n  }\n\n  private _shrinkTitle() {\n    if (this._doesTitleOverflow()) {\n      let { truncatedTitleFirstPiece, truncatedTitleSecondPiece } = this.state;\n      this.setState({\n        truncatedTitleFirstPiece : truncatedTitleFirstPiece.slice(0, truncatedTitleFirstPiece.length - 1),\n        truncatedTitleSecondPiece : truncatedTitleSecondPiece.slice(1)\n      });\n    }\n  }\n\n  private _doesTitleOverflow(): boolean {\n    let titleElement = this.refs.titleElement;\n    return titleElement.scrollHeight > titleElement.clientHeight + TRUNCATION_VERTICAL_OVERFLOW_THRESHOLD || titleElement.scrollWidth > titleElement.clientWidth;\n  }\n\n  private _updateTruncation() {\n    // Only update truncation if the title's size has changed since the last time we truncated\n    if (this.refs.titleElement.clientWidth !== this._truncatedTitleAtWidth) {\n      // Throttle truncation so that it doesn't happen during a window resize\n      clearTimeout(this._scrollTimerId);\n      this._scrollTimerId = setTimeout(this._startTruncation, 250);\n    }\n  }\n\n}\n"],"sourceRoot":"/src"}